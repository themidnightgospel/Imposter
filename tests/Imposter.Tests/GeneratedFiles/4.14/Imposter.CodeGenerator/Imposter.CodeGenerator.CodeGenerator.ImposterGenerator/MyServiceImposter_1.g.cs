// <auto-generated />
#nullable enable
using global::System;
using global::System.Linq;
using global::System.Collections.Generic;
using global::System.Threading.Tasks;
using global::System.Diagnostics;
using global::System.Runtime.CompilerServices;
using global::Imposter.Abstractions;
using global::System.Collections.Concurrent;
using global::Imposter.Tests.Features.Docs.Methods.UseBaseImplementation;

namespace Imposter.Tests.Features.Docs.Methods.UseBaseImplementation
{
    [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
    public sealed class MyServiceImposter : global::Imposter.Abstractions.IHaveImposterInstance<global::Imposter.Tests.Features.Docs.Methods.UseBaseImplementation.MyService>
    {
        private readonly AddMethodImposter _addMethodImposter;
        private readonly ProcessAsyncMethodImposter _processAsyncMethodImposter;
        private readonly MightFailMethodImposter _mightFailMethodImposter;
        private readonly AddMethodInvocationHistoryCollection _addMethodInvocationHistoryCollection = new AddMethodInvocationHistoryCollection();
        private readonly ProcessAsyncMethodInvocationHistoryCollection _processAsyncMethodInvocationHistoryCollection = new ProcessAsyncMethodInvocationHistoryCollection();
        private readonly MightFailMethodInvocationHistoryCollection _mightFailMethodInvocationHistoryCollection = new MightFailMethodInvocationHistoryCollection();
        public IAddMethodImposterBuilder Add(global::Imposter.Abstractions.Arg<int> a, global::Imposter.Abstractions.Arg<int> b)
        {
            return new AddMethodImposter.Builder(_addMethodImposter, _addMethodInvocationHistoryCollection, new AddArgumentsCriteria(a, b));
        }

        public IProcessAsyncMethodImposterBuilder ProcessAsync(global::Imposter.Abstractions.Arg<string> s)
        {
            return new ProcessAsyncMethodImposter.Builder(_processAsyncMethodImposter, _processAsyncMethodInvocationHistoryCollection, new ProcessAsyncArgumentsCriteria(s));
        }

        public IMightFailMethodImposterBuilder MightFail(global::Imposter.Abstractions.Arg<int> v)
        {
            return new MightFailMethodImposter.Builder(_mightFailMethodImposter, _mightFailMethodInvocationHistoryCollection, new MightFailArgumentsCriteria(v));
        }

        private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
        private ImposterTargetInstance _imposterInstance;
        global::Imposter.Tests.Features.Docs.Methods.UseBaseImplementation.MyService global::Imposter.Abstractions.IHaveImposterInstance<global::Imposter.Tests.Features.Docs.Methods.UseBaseImplementation.MyService>.Instance()
        {
            return _imposterInstance;
        }

        // virtual int MyService.Add(int a, int b)
        public delegate int AddDelegate(int a, int b);
        // virtual int MyService.Add(int a, int b)
        public delegate void AddCallbackDelegate(int a, int b);
        // virtual int MyService.Add(int a, int b)
        public delegate global::System.Exception AddExceptionGeneratorDelegate(int a, int b);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class AddArguments
        {
            public int a;
            public int b;
            internal AddArguments(int a, int b)
            {
                this.a = a;
                this.b = b;
            }
        }

        // virtual int MyService.Add(int a, int b)
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class AddArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<int> a { get; }
            public global::Imposter.Abstractions.Arg<int> b { get; }

            public AddArgumentsCriteria(global::Imposter.Abstractions.Arg<int> a, global::Imposter.Abstractions.Arg<int> b)
            {
                this.a = a;
                this.b = b;
            }

            public bool Matches(AddArguments arguments)
            {
                return a.Matches(arguments.a) && b.Matches(arguments.b);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IAddMethodInvocationHistory
        {
            bool Matches(AddArgumentsCriteria criteria);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class AddMethodInvocationHistory : IAddMethodInvocationHistory
        {
            internal AddArguments Arguments;
            internal int? Result;
            internal global::System.Exception? Exception;
            public AddMethodInvocationHistory(AddArguments Arguments, int? Result, global::System.Exception? Exception)
            {
                this.Arguments = Arguments;
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches(AddArgumentsCriteria criteria)
            {
                return criteria.Matches(Arguments);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class AddMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IAddMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IAddMethodInvocationHistory>();
            internal void Add(IAddMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count(AddArgumentsCriteria argumentsCriteria)
            {
                return _invocationHistory.Count(it => it.Matches(argumentsCriteria));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class AddMethodInvocationImposterGroup
        {
            internal static AddMethodInvocationImposterGroup Default = new AddMethodInvocationImposterGroup(new AddArgumentsCriteria(global::Imposter.Abstractions.Arg<int>.Any(), global::Imposter.Abstractions.Arg<int>.Any()));
            internal AddArgumentsCriteria ArgumentsCriteria { get; }

            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public AddMethodInvocationImposterGroup(AddArgumentsCriteria argumentsCriteria)
            {
                ArgumentsCriteria = argumentsCriteria;
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, int a, int b, AddDelegate? baseImplementation = null)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, a, b, baseImplementation);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private AddDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<AddCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<AddCallbackDelegate>();
                private bool _useBaseImplementation;
                internal bool IsEmpty => !_useBaseImplementation && ((_resultGenerator == null) && (_callbacks.Count == 0));

                public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, int a, int b, AddDelegate? baseImplementation = null)
                {
                    if (_useBaseImplementation)
                    {
                        _resultGenerator = baseImplementation ?? throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    int result = _resultGenerator.Invoke(a, b);
                    foreach (var callback in _callbacks)
                    {
                        callback(a, b);
                    }

                    return result;
                }

                internal void Callback(AddCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(AddDelegate resultGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(int value)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = (int a, int b) =>
                    {
                        return value;
                    };
                }

                internal void Throws(AddExceptionGeneratorDelegate exceptionGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = (int a, int b) =>
                    {
                        throw exceptionGenerator(a, b);
                    };
                }

                internal void UseBaseImplementation()
                {
                    _useBaseImplementation = true;
                    _resultGenerator = null;
                }

                internal static int DefaultResultGenerator(int a, int b)
                {
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IAddMethodInvocationImposterGroupCallback
        {
            IAddMethodInvocationImposterGroupContinuation Callback(AddCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IAddMethodInvocationImposterGroupContinuation : IAddMethodInvocationImposterGroupCallback
        {
            IAddMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IAddMethodInvocationImposterGroup : IAddMethodInvocationImposterGroupCallback
        {
            IAddMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IAddMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IAddMethodInvocationImposterGroupContinuation Throws(AddExceptionGeneratorDelegate exceptionGenerator);
            IAddMethodInvocationImposterGroupContinuation Returns(AddDelegate resultGenerator);
            IAddMethodInvocationImposterGroupContinuation Returns(int value);
            IAddMethodInvocationImposterGroupContinuation UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface AddInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IAddMethodImposterBuilder : IAddMethodInvocationImposterGroup, IAddMethodInvocationImposterGroupCallback, AddInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class AddMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<AddMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<AddMethodInvocationImposterGroup>();
            private readonly AddMethodInvocationHistoryCollection _addMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public AddMethodImposter(AddMethodInvocationHistoryCollection _addMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._addMethodInvocationHistoryCollection = _addMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup(AddArguments arguments)
            {
                return FindMatchingInvocationImposterGroup(arguments) != null;
            }

            private AddMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup(AddArguments arguments)
            {
                foreach (var invocationImposterGroup in _invocationImposters)
                {
                    if (invocationImposterGroup.ArgumentsCriteria.Matches(arguments))
                        return invocationImposterGroup;
                }

                return null;
            }

            public int Invoke(int a, int b, AddDelegate? baseImplementation = null)
            {
                var arguments = new AddArguments(a, b);
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup(arguments);
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("virtual int MyService.Add(int a, int b)");
                    }

                    matchingInvocationImposterGroup = AddMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "virtual int MyService.Add(int a, int b)", a, b, baseImplementation);
                    _addMethodInvocationHistoryCollection.Add(new AddMethodInvocationHistory(arguments, result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _addMethodInvocationHistoryCollection.Add(new AddMethodInvocationHistory(arguments, default, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IAddMethodImposterBuilder, IAddMethodInvocationImposterGroupContinuation
            {
                private readonly AddMethodImposter _imposter;
                private readonly AddMethodInvocationHistoryCollection _addMethodInvocationHistoryCollection;
                private readonly AddArgumentsCriteria _argumentsCriteria;
                private readonly AddMethodInvocationImposterGroup _invocationImposterGroup;
                private AddMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(AddMethodImposter _imposter, AddMethodInvocationHistoryCollection _addMethodInvocationHistoryCollection, AddArgumentsCriteria _argumentsCriteria)
                {
                    this._imposter = _imposter;
                    this._addMethodInvocationHistoryCollection = _addMethodInvocationHistoryCollection;
                    this._argumentsCriteria = _argumentsCriteria;
                    this._invocationImposterGroup = new AddMethodInvocationImposterGroup(_argumentsCriteria);
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((int a, int b) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((int a, int b) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroup.Throws(AddExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((int a, int b) =>
                    {
                        throw exceptionGenerator.Invoke(a, b);
                    });
                    return this;
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroupCallback.Callback(AddCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroup.Returns(AddDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroup.Returns(int value)
                {
                    _currentInvocationImposter.Returns(value);
                    return this;
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroup.UseBaseImplementation()
                {
                    _currentInvocationImposter.UseBaseImplementation();
                    return this;
                }

                IAddMethodInvocationImposterGroup IAddMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void AddInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _addMethodInvocationHistoryCollection.Count(_argumentsCriteria);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount);
                    }
                }
            }
        }

        // virtual int MyService.MightFail(int v)
        public delegate int MightFailDelegate(int v);
        // virtual int MyService.MightFail(int v)
        public delegate void MightFailCallbackDelegate(int v);
        // virtual int MyService.MightFail(int v)
        public delegate global::System.Exception MightFailExceptionGeneratorDelegate(int v);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class MightFailArguments
        {
            public int v;
            internal MightFailArguments(int v)
            {
                this.v = v;
            }
        }

        // virtual int MyService.MightFail(int v)
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class MightFailArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<int> v { get; }

            public MightFailArgumentsCriteria(global::Imposter.Abstractions.Arg<int> v)
            {
                this.v = v;
            }

            public bool Matches(MightFailArguments arguments)
            {
                return v.Matches(arguments.v);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IMightFailMethodInvocationHistory
        {
            bool Matches(MightFailArgumentsCriteria criteria);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class MightFailMethodInvocationHistory : IMightFailMethodInvocationHistory
        {
            internal MightFailArguments Arguments;
            internal int? Result;
            internal global::System.Exception? Exception;
            public MightFailMethodInvocationHistory(MightFailArguments Arguments, int? Result, global::System.Exception? Exception)
            {
                this.Arguments = Arguments;
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches(MightFailArgumentsCriteria criteria)
            {
                return criteria.Matches(Arguments);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class MightFailMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IMightFailMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IMightFailMethodInvocationHistory>();
            internal void Add(IMightFailMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count(MightFailArgumentsCriteria argumentsCriteria)
            {
                return _invocationHistory.Count(it => it.Matches(argumentsCriteria));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class MightFailMethodInvocationImposterGroup
        {
            internal static MightFailMethodInvocationImposterGroup Default = new MightFailMethodInvocationImposterGroup(new MightFailArgumentsCriteria(global::Imposter.Abstractions.Arg<int>.Any()));
            internal MightFailArgumentsCriteria ArgumentsCriteria { get; }

            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public MightFailMethodInvocationImposterGroup(MightFailArgumentsCriteria argumentsCriteria)
            {
                ArgumentsCriteria = argumentsCriteria;
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, int v, MightFailDelegate? baseImplementation = null)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, v, baseImplementation);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private MightFailDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<MightFailCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<MightFailCallbackDelegate>();
                private bool _useBaseImplementation;
                internal bool IsEmpty => !_useBaseImplementation && ((_resultGenerator == null) && (_callbacks.Count == 0));

                public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, int v, MightFailDelegate? baseImplementation = null)
                {
                    if (_useBaseImplementation)
                    {
                        _resultGenerator = baseImplementation ?? throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    int result = _resultGenerator.Invoke(v);
                    foreach (var callback in _callbacks)
                    {
                        callback(v);
                    }

                    return result;
                }

                internal void Callback(MightFailCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(MightFailDelegate resultGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(int value)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = (int v) =>
                    {
                        return value;
                    };
                }

                internal void Throws(MightFailExceptionGeneratorDelegate exceptionGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = (int v) =>
                    {
                        throw exceptionGenerator(v);
                    };
                }

                internal void UseBaseImplementation()
                {
                    _useBaseImplementation = true;
                    _resultGenerator = null;
                }

                internal static int DefaultResultGenerator(int v)
                {
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IMightFailMethodInvocationImposterGroupCallback
        {
            IMightFailMethodInvocationImposterGroupContinuation Callback(MightFailCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IMightFailMethodInvocationImposterGroupContinuation : IMightFailMethodInvocationImposterGroupCallback
        {
            IMightFailMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IMightFailMethodInvocationImposterGroup : IMightFailMethodInvocationImposterGroupCallback
        {
            IMightFailMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IMightFailMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IMightFailMethodInvocationImposterGroupContinuation Throws(MightFailExceptionGeneratorDelegate exceptionGenerator);
            IMightFailMethodInvocationImposterGroupContinuation Returns(MightFailDelegate resultGenerator);
            IMightFailMethodInvocationImposterGroupContinuation Returns(int value);
            IMightFailMethodInvocationImposterGroupContinuation UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface MightFailInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IMightFailMethodImposterBuilder : IMightFailMethodInvocationImposterGroup, IMightFailMethodInvocationImposterGroupCallback, MightFailInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class MightFailMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<MightFailMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<MightFailMethodInvocationImposterGroup>();
            private readonly MightFailMethodInvocationHistoryCollection _mightFailMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public MightFailMethodImposter(MightFailMethodInvocationHistoryCollection _mightFailMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._mightFailMethodInvocationHistoryCollection = _mightFailMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup(MightFailArguments arguments)
            {
                return FindMatchingInvocationImposterGroup(arguments) != null;
            }

            private MightFailMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup(MightFailArguments arguments)
            {
                foreach (var invocationImposterGroup in _invocationImposters)
                {
                    if (invocationImposterGroup.ArgumentsCriteria.Matches(arguments))
                        return invocationImposterGroup;
                }

                return null;
            }

            public int Invoke(int v, MightFailDelegate? baseImplementation = null)
            {
                var arguments = new MightFailArguments(v);
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup(arguments);
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("virtual int MyService.MightFail(int v)");
                    }

                    matchingInvocationImposterGroup = MightFailMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "virtual int MyService.MightFail(int v)", v, baseImplementation);
                    _mightFailMethodInvocationHistoryCollection.Add(new MightFailMethodInvocationHistory(arguments, result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _mightFailMethodInvocationHistoryCollection.Add(new MightFailMethodInvocationHistory(arguments, default, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IMightFailMethodImposterBuilder, IMightFailMethodInvocationImposterGroupContinuation
            {
                private readonly MightFailMethodImposter _imposter;
                private readonly MightFailMethodInvocationHistoryCollection _mightFailMethodInvocationHistoryCollection;
                private readonly MightFailArgumentsCriteria _argumentsCriteria;
                private readonly MightFailMethodInvocationImposterGroup _invocationImposterGroup;
                private MightFailMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(MightFailMethodImposter _imposter, MightFailMethodInvocationHistoryCollection _mightFailMethodInvocationHistoryCollection, MightFailArgumentsCriteria _argumentsCriteria)
                {
                    this._imposter = _imposter;
                    this._mightFailMethodInvocationHistoryCollection = _mightFailMethodInvocationHistoryCollection;
                    this._argumentsCriteria = _argumentsCriteria;
                    this._invocationImposterGroup = new MightFailMethodInvocationImposterGroup(_argumentsCriteria);
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IMightFailMethodInvocationImposterGroupContinuation IMightFailMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((int v) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IMightFailMethodInvocationImposterGroupContinuation IMightFailMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((int v) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IMightFailMethodInvocationImposterGroupContinuation IMightFailMethodInvocationImposterGroup.Throws(MightFailExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((int v) =>
                    {
                        throw exceptionGenerator.Invoke(v);
                    });
                    return this;
                }

                IMightFailMethodInvocationImposterGroupContinuation IMightFailMethodInvocationImposterGroupCallback.Callback(MightFailCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IMightFailMethodInvocationImposterGroupContinuation IMightFailMethodInvocationImposterGroup.Returns(MightFailDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IMightFailMethodInvocationImposterGroupContinuation IMightFailMethodInvocationImposterGroup.Returns(int value)
                {
                    _currentInvocationImposter.Returns(value);
                    return this;
                }

                IMightFailMethodInvocationImposterGroupContinuation IMightFailMethodInvocationImposterGroup.UseBaseImplementation()
                {
                    _currentInvocationImposter.UseBaseImplementation();
                    return this;
                }

                IMightFailMethodInvocationImposterGroup IMightFailMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void MightFailInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _mightFailMethodInvocationHistoryCollection.Count(_argumentsCriteria);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount);
                    }
                }
            }
        }

        // virtual Task MyService.ProcessAsync(string s)
        public delegate global::System.Threading.Tasks.Task ProcessAsyncDelegate(string s);
        // virtual Task MyService.ProcessAsync(string s)
        public delegate global::System.Threading.Tasks.Task ProcessAsyncCallbackDelegate(string s);
        // virtual Task MyService.ProcessAsync(string s)
        public delegate global::System.Exception ProcessAsyncExceptionGeneratorDelegate(string s);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class ProcessAsyncArguments
        {
            public string s;
            internal ProcessAsyncArguments(string s)
            {
                this.s = s;
            }
        }

        // virtual Task MyService.ProcessAsync(string s)
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class ProcessAsyncArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<string> s { get; }

            public ProcessAsyncArgumentsCriteria(global::Imposter.Abstractions.Arg<string> s)
            {
                this.s = s;
            }

            public bool Matches(ProcessAsyncArguments arguments)
            {
                return s.Matches(arguments.s);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IProcessAsyncMethodInvocationHistory
        {
            bool Matches(ProcessAsyncArgumentsCriteria criteria);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class ProcessAsyncMethodInvocationHistory : IProcessAsyncMethodInvocationHistory
        {
            internal ProcessAsyncArguments Arguments;
            internal global::System.Threading.Tasks.Task Result;
            internal global::System.Exception? Exception;
            public ProcessAsyncMethodInvocationHistory(ProcessAsyncArguments Arguments, global::System.Threading.Tasks.Task Result, global::System.Exception? Exception)
            {
                this.Arguments = Arguments;
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches(ProcessAsyncArgumentsCriteria criteria)
            {
                return criteria.Matches(Arguments);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class ProcessAsyncMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IProcessAsyncMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IProcessAsyncMethodInvocationHistory>();
            internal void Add(IProcessAsyncMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count(ProcessAsyncArgumentsCriteria argumentsCriteria)
            {
                return _invocationHistory.Count(it => it.Matches(argumentsCriteria));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class ProcessAsyncMethodInvocationImposterGroup
        {
            internal static ProcessAsyncMethodInvocationImposterGroup Default = new ProcessAsyncMethodInvocationImposterGroup(new ProcessAsyncArgumentsCriteria(global::Imposter.Abstractions.Arg<string>.Any()));
            internal ProcessAsyncArgumentsCriteria ArgumentsCriteria { get; }

            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public ProcessAsyncMethodInvocationImposterGroup(ProcessAsyncArgumentsCriteria argumentsCriteria)
            {
                ArgumentsCriteria = argumentsCriteria;
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public global::System.Threading.Tasks.Task Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, string s, ProcessAsyncDelegate? baseImplementation = null)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, s, baseImplementation);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private ProcessAsyncDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<ProcessAsyncCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<ProcessAsyncCallbackDelegate>();
                private bool _useBaseImplementation;
                internal bool IsEmpty => !_useBaseImplementation && ((_resultGenerator == null) && (_callbacks.Count == 0));

                public global::System.Threading.Tasks.Task Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, string s, ProcessAsyncDelegate? baseImplementation = null)
                {
                    if (_useBaseImplementation)
                    {
                        _resultGenerator = baseImplementation ?? throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    global::System.Threading.Tasks.Task result = _resultGenerator.Invoke(s);
                    foreach (var callback in _callbacks)
                    {
                        callback(s);
                    }

                    return result;
                }

                internal void Callback(ProcessAsyncCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(ProcessAsyncDelegate resultGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(global::System.Threading.Tasks.Task value)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = (string s) =>
                    {
                        return value;
                    };
                }

                internal void Throws(ProcessAsyncExceptionGeneratorDelegate exceptionGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = (string s) =>
                    {
                        throw exceptionGenerator(s);
                    };
                }

                internal void ThrowsAsync(global::System.Exception exception)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = async (string s) =>
                    {
                        throw exception;
                    };
                }

                internal void UseBaseImplementation()
                {
                    _useBaseImplementation = true;
                    _resultGenerator = null;
                }

                internal static async global::System.Threading.Tasks.Task DefaultResultGenerator(string s)
                {
                    return;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IProcessAsyncMethodInvocationImposterGroupCallback
        {
            IProcessAsyncMethodInvocationImposterGroupContinuation Callback(ProcessAsyncCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IProcessAsyncMethodInvocationImposterGroupContinuation : IProcessAsyncMethodInvocationImposterGroupCallback
        {
            IProcessAsyncMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IProcessAsyncMethodInvocationImposterGroup : IProcessAsyncMethodInvocationImposterGroupCallback
        {
            IProcessAsyncMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IProcessAsyncMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IProcessAsyncMethodInvocationImposterGroupContinuation Throws(ProcessAsyncExceptionGeneratorDelegate exceptionGenerator);
            IProcessAsyncMethodInvocationImposterGroupContinuation Returns(ProcessAsyncDelegate resultGenerator);
            IProcessAsyncMethodInvocationImposterGroupContinuation Returns(global::System.Threading.Tasks.Task value);
            IProcessAsyncMethodInvocationImposterGroupContinuation ThrowsAsync(global::System.Exception exception);
            IProcessAsyncMethodInvocationImposterGroupContinuation UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ProcessAsyncInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IProcessAsyncMethodImposterBuilder : IProcessAsyncMethodInvocationImposterGroup, IProcessAsyncMethodInvocationImposterGroupCallback, ProcessAsyncInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class ProcessAsyncMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<ProcessAsyncMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<ProcessAsyncMethodInvocationImposterGroup>();
            private readonly ProcessAsyncMethodInvocationHistoryCollection _processAsyncMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public ProcessAsyncMethodImposter(ProcessAsyncMethodInvocationHistoryCollection _processAsyncMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._processAsyncMethodInvocationHistoryCollection = _processAsyncMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup(ProcessAsyncArguments arguments)
            {
                return FindMatchingInvocationImposterGroup(arguments) != null;
            }

            private ProcessAsyncMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup(ProcessAsyncArguments arguments)
            {
                foreach (var invocationImposterGroup in _invocationImposters)
                {
                    if (invocationImposterGroup.ArgumentsCriteria.Matches(arguments))
                        return invocationImposterGroup;
                }

                return null;
            }

            public global::System.Threading.Tasks.Task Invoke(string s, ProcessAsyncDelegate? baseImplementation = null)
            {
                var arguments = new ProcessAsyncArguments(s);
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup(arguments);
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("virtual Task MyService.ProcessAsync(string s)");
                    }

                    matchingInvocationImposterGroup = ProcessAsyncMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "virtual Task MyService.ProcessAsync(string s)", s, baseImplementation);
                    _processAsyncMethodInvocationHistoryCollection.Add(new ProcessAsyncMethodInvocationHistory(arguments, result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _processAsyncMethodInvocationHistoryCollection.Add(new ProcessAsyncMethodInvocationHistory(arguments, default, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IProcessAsyncMethodImposterBuilder, IProcessAsyncMethodInvocationImposterGroupContinuation
            {
                private readonly ProcessAsyncMethodImposter _imposter;
                private readonly ProcessAsyncMethodInvocationHistoryCollection _processAsyncMethodInvocationHistoryCollection;
                private readonly ProcessAsyncArgumentsCriteria _argumentsCriteria;
                private readonly ProcessAsyncMethodInvocationImposterGroup _invocationImposterGroup;
                private ProcessAsyncMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(ProcessAsyncMethodImposter _imposter, ProcessAsyncMethodInvocationHistoryCollection _processAsyncMethodInvocationHistoryCollection, ProcessAsyncArgumentsCriteria _argumentsCriteria)
                {
                    this._imposter = _imposter;
                    this._processAsyncMethodInvocationHistoryCollection = _processAsyncMethodInvocationHistoryCollection;
                    this._argumentsCriteria = _argumentsCriteria;
                    this._invocationImposterGroup = new ProcessAsyncMethodInvocationImposterGroup(_argumentsCriteria);
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IProcessAsyncMethodInvocationImposterGroupContinuation IProcessAsyncMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((string s) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IProcessAsyncMethodInvocationImposterGroupContinuation IProcessAsyncMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((string s) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IProcessAsyncMethodInvocationImposterGroupContinuation IProcessAsyncMethodInvocationImposterGroup.Throws(ProcessAsyncExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((string s) =>
                    {
                        throw exceptionGenerator.Invoke(s);
                    });
                    return this;
                }

                IProcessAsyncMethodInvocationImposterGroupContinuation IProcessAsyncMethodInvocationImposterGroupCallback.Callback(ProcessAsyncCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IProcessAsyncMethodInvocationImposterGroupContinuation IProcessAsyncMethodInvocationImposterGroup.Returns(ProcessAsyncDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IProcessAsyncMethodInvocationImposterGroupContinuation IProcessAsyncMethodInvocationImposterGroup.Returns(global::System.Threading.Tasks.Task value)
                {
                    _currentInvocationImposter.Returns(value);
                    return this;
                }

                IProcessAsyncMethodInvocationImposterGroupContinuation IProcessAsyncMethodInvocationImposterGroup.ThrowsAsync(global::System.Exception exception)
                {
                    _currentInvocationImposter.ThrowsAsync(exception);
                    return this;
                }

                IProcessAsyncMethodInvocationImposterGroupContinuation IProcessAsyncMethodInvocationImposterGroup.UseBaseImplementation()
                {
                    _currentInvocationImposter.UseBaseImplementation();
                    return this;
                }

                IProcessAsyncMethodInvocationImposterGroup IProcessAsyncMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void ProcessAsyncInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _processAsyncMethodInvocationHistoryCollection.Count(_argumentsCriteria);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount);
                    }
                }
            }
        }

        public MyServiceImposter(global::Imposter.Abstractions.ImposterMode invocationBehavior = global::Imposter.Abstractions.ImposterMode.Implicit)
        {
            this._addMethodImposter = new AddMethodImposter(_addMethodInvocationHistoryCollection, invocationBehavior);
            this._processAsyncMethodImposter = new ProcessAsyncMethodImposter(_processAsyncMethodInvocationHistoryCollection, invocationBehavior);
            this._mightFailMethodImposter = new MightFailMethodImposter(_mightFailMethodInvocationHistoryCollection, invocationBehavior);
            this._imposterInstance = new ImposterTargetInstance(this);
            this._invocationBehavior = invocationBehavior;
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class ImposterTargetInstance : global::Imposter.Tests.Features.Docs.Methods.UseBaseImplementation.MyService
        {
            private readonly MyServiceImposter _imposter;
            internal ImposterTargetInstance(MyServiceImposter _imposter) : base()
            {
                this._imposter = _imposter;
            }

            public override int Add(int a, int b)
            {
                return _imposter._addMethodImposter.Invoke(a, b, base.Add);
            }

            public override global::System.Threading.Tasks.Task ProcessAsync(string s)
            {
                return _imposter._processAsyncMethodImposter.Invoke(s, base.ProcessAsync);
            }

            public override int MightFail(int v)
            {
                return _imposter._mightFailMethodImposter.Invoke(v, base.MightFail);
            }
        }
    }
}
#nullable restore
