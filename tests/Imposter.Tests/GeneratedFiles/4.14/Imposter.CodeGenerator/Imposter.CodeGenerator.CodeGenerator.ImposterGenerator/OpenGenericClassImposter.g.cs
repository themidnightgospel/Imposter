// <auto-generated />
#nullable enable
using global::System;
using global::System.Linq;
using global::System.Collections.Generic;
using global::System.Threading.Tasks;
using global::System.Diagnostics;
using global::System.Runtime.CompilerServices;
using global::Imposter.Abstractions;
using global::System.Collections.Concurrent;
using global::Imposter.Tests.Features.OpenGenericImposter;

namespace Imposter.Tests.Features.OpenGenericImposter
{
    [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
    public sealed class OpenGenericClassImposter<T> : global::Imposter.Abstractions.IHaveImposterInstance<global::Imposter.Tests.Features.OpenGenericImposter.OpenGenericClass<T>> where T : class
    {
        private readonly DescribeMethodImposter _describeMethodImposter;
        private readonly EchoMethodImposter _echoMethodImposter;
        private readonly DescribeMethodInvocationHistoryCollection _describeMethodInvocationHistoryCollection = new DescribeMethodInvocationHistoryCollection();
        private readonly EchoMethodInvocationHistoryCollection _echoMethodInvocationHistoryCollection = new EchoMethodInvocationHistoryCollection();
        public IDescribeMethodImposterBuilder Describe(global::Imposter.Abstractions.Arg<T> value)
        {
            return new DescribeMethodImposter.Builder(_describeMethodImposter, _describeMethodInvocationHistoryCollection, new DescribeArgumentsCriteria(value));
        }

        public IEchoMethodImposterBuilder Echo(global::Imposter.Abstractions.Arg<T> value)
        {
            return new EchoMethodImposter.Builder(_echoMethodImposter, _echoMethodInvocationHistoryCollection, new EchoArgumentsCriteria(value));
        }

        private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
        private ImposterTargetInstance _imposterInstance;
        global::Imposter.Tests.Features.OpenGenericImposter.OpenGenericClass<T> global::Imposter.Abstractions.IHaveImposterInstance<global::Imposter.Tests.Features.OpenGenericImposter.OpenGenericClass<T>>.Instance()
        {
            return _imposterInstance;
        }

        // virtual string OpenGenericClass<T>.Describe(T value)
        public delegate string DescribeDelegate(T value);
        // virtual string OpenGenericClass<T>.Describe(T value)
        public delegate void DescribeCallbackDelegate(T value);
        // virtual string OpenGenericClass<T>.Describe(T value)
        public delegate global::System.Exception DescribeExceptionGeneratorDelegate(T value);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class DescribeArguments
        {
            public T value;
            internal DescribeArguments(T value)
            {
                this.value = value;
            }
        }

        // virtual string OpenGenericClass<T>.Describe(T value)
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class DescribeArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<T> value { get; }

            public DescribeArgumentsCriteria(global::Imposter.Abstractions.Arg<T> value)
            {
                this.value = value;
            }

            public bool Matches(DescribeArguments arguments)
            {
                return value.Matches(arguments.value);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IDescribeMethodInvocationHistory
        {
            bool Matches(DescribeArgumentsCriteria criteria);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class DescribeMethodInvocationHistory : IDescribeMethodInvocationHistory
        {
            internal DescribeArguments Arguments;
            internal string? Result;
            internal global::System.Exception? Exception;
            public DescribeMethodInvocationHistory(DescribeArguments Arguments, string? Result, global::System.Exception? Exception)
            {
                this.Arguments = Arguments;
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches(DescribeArgumentsCriteria criteria)
            {
                return criteria.Matches(Arguments);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class DescribeMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IDescribeMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IDescribeMethodInvocationHistory>();
            internal void Add(IDescribeMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count(DescribeArgumentsCriteria argumentsCriteria)
            {
                return _invocationHistory.Count(it => it.Matches(argumentsCriteria));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class DescribeMethodInvocationImposterGroup
        {
            internal static DescribeMethodInvocationImposterGroup Default = new DescribeMethodInvocationImposterGroup(new DescribeArgumentsCriteria(global::Imposter.Abstractions.Arg<T>.Any()));
            internal DescribeArgumentsCriteria ArgumentsCriteria { get; }

            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public DescribeMethodInvocationImposterGroup(DescribeArgumentsCriteria argumentsCriteria)
            {
                ArgumentsCriteria = argumentsCriteria;
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public string Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, T value, DescribeDelegate? baseImplementation = null)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, value, baseImplementation);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private DescribeDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<DescribeCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<DescribeCallbackDelegate>();
                private bool _useBaseImplementation;
                internal bool IsEmpty => !_useBaseImplementation && ((_resultGenerator == null) && (_callbacks.Count == 0));

                public string Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, T value, DescribeDelegate? baseImplementation = null)
                {
                    if (_useBaseImplementation)
                    {
                        _resultGenerator = baseImplementation ?? throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    string result = _resultGenerator.Invoke(value);
                    foreach (var callback in _callbacks)
                    {
                        callback(value);
                    }

                    return result;
                }

                internal void Callback(DescribeCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(DescribeDelegate resultGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(string value_1)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = (T value) =>
                    {
                        return value_1;
                    };
                }

                internal void Throws(DescribeExceptionGeneratorDelegate exceptionGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = (T value) =>
                    {
                        throw exceptionGenerator(value);
                    };
                }

                internal void UseBaseImplementation()
                {
                    _useBaseImplementation = true;
                    _resultGenerator = null;
                }

                internal static string DefaultResultGenerator(T value)
                {
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IDescribeMethodInvocationImposterGroupCallback
        {
            IDescribeMethodInvocationImposterGroupContinuation Callback(DescribeCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IDescribeMethodInvocationImposterGroupContinuation : IDescribeMethodInvocationImposterGroupCallback
        {
            IDescribeMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IDescribeMethodInvocationImposterGroup : IDescribeMethodInvocationImposterGroupCallback
        {
            IDescribeMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IDescribeMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IDescribeMethodInvocationImposterGroupContinuation Throws(DescribeExceptionGeneratorDelegate exceptionGenerator);
            IDescribeMethodInvocationImposterGroupContinuation Returns(DescribeDelegate resultGenerator);
            IDescribeMethodInvocationImposterGroupContinuation Returns(string value);
            IDescribeMethodInvocationImposterGroupContinuation UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface DescribeInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IDescribeMethodImposterBuilder : IDescribeMethodInvocationImposterGroup, IDescribeMethodInvocationImposterGroupCallback, DescribeInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class DescribeMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<DescribeMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<DescribeMethodInvocationImposterGroup>();
            private readonly DescribeMethodInvocationHistoryCollection _describeMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public DescribeMethodImposter(DescribeMethodInvocationHistoryCollection _describeMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._describeMethodInvocationHistoryCollection = _describeMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup(DescribeArguments arguments)
            {
                return FindMatchingInvocationImposterGroup(arguments) != null;
            }

            private DescribeMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup(DescribeArguments arguments)
            {
                foreach (var invocationImposterGroup in _invocationImposters)
                {
                    if (invocationImposterGroup.ArgumentsCriteria.Matches(arguments))
                        return invocationImposterGroup;
                }

                return null;
            }

            public string Invoke(T value, DescribeDelegate? baseImplementation = null)
            {
                var arguments = new DescribeArguments(value);
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup(arguments);
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("virtual string OpenGenericClass<T>.Describe(T value)");
                    }

                    matchingInvocationImposterGroup = DescribeMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "virtual string OpenGenericClass<T>.Describe(T value)", value, baseImplementation);
                    _describeMethodInvocationHistoryCollection.Add(new DescribeMethodInvocationHistory(arguments, result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _describeMethodInvocationHistoryCollection.Add(new DescribeMethodInvocationHistory(arguments, default !, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IDescribeMethodImposterBuilder, IDescribeMethodInvocationImposterGroupContinuation
            {
                private readonly DescribeMethodImposter _imposter;
                private readonly DescribeMethodInvocationHistoryCollection _describeMethodInvocationHistoryCollection;
                private readonly DescribeArgumentsCriteria _argumentsCriteria;
                private readonly DescribeMethodInvocationImposterGroup _invocationImposterGroup;
                private DescribeMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(DescribeMethodImposter _imposter, DescribeMethodInvocationHistoryCollection _describeMethodInvocationHistoryCollection, DescribeArgumentsCriteria _argumentsCriteria)
                {
                    this._imposter = _imposter;
                    this._describeMethodInvocationHistoryCollection = _describeMethodInvocationHistoryCollection;
                    this._argumentsCriteria = _argumentsCriteria;
                    this._invocationImposterGroup = new DescribeMethodInvocationImposterGroup(_argumentsCriteria);
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IDescribeMethodInvocationImposterGroupContinuation IDescribeMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((T value) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IDescribeMethodInvocationImposterGroupContinuation IDescribeMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((T value) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IDescribeMethodInvocationImposterGroupContinuation IDescribeMethodInvocationImposterGroup.Throws(DescribeExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((T value) =>
                    {
                        throw exceptionGenerator.Invoke(value);
                    });
                    return this;
                }

                IDescribeMethodInvocationImposterGroupContinuation IDescribeMethodInvocationImposterGroupCallback.Callback(DescribeCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IDescribeMethodInvocationImposterGroupContinuation IDescribeMethodInvocationImposterGroup.Returns(DescribeDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IDescribeMethodInvocationImposterGroupContinuation IDescribeMethodInvocationImposterGroup.Returns(string value_1)
                {
                    _currentInvocationImposter.Returns(value_1);
                    return this;
                }

                IDescribeMethodInvocationImposterGroupContinuation IDescribeMethodInvocationImposterGroup.UseBaseImplementation()
                {
                    _currentInvocationImposter.UseBaseImplementation();
                    return this;
                }

                IDescribeMethodInvocationImposterGroup IDescribeMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void DescribeInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _describeMethodInvocationHistoryCollection.Count(_argumentsCriteria);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount);
                    }
                }
            }
        }

        // virtual T OpenGenericClass<T>.Echo(T value)
        public delegate T EchoDelegate(T value);
        // virtual T OpenGenericClass<T>.Echo(T value)
        public delegate void EchoCallbackDelegate(T value);
        // virtual T OpenGenericClass<T>.Echo(T value)
        public delegate global::System.Exception EchoExceptionGeneratorDelegate(T value);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class EchoArguments
        {
            public T value;
            internal EchoArguments(T value)
            {
                this.value = value;
            }
        }

        // virtual T OpenGenericClass<T>.Echo(T value)
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class EchoArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<T> value { get; }

            public EchoArgumentsCriteria(global::Imposter.Abstractions.Arg<T> value)
            {
                this.value = value;
            }

            public bool Matches(EchoArguments arguments)
            {
                return value.Matches(arguments.value);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IEchoMethodInvocationHistory
        {
            bool Matches(EchoArgumentsCriteria criteria);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class EchoMethodInvocationHistory : IEchoMethodInvocationHistory
        {
            internal EchoArguments Arguments;
            internal T? Result;
            internal global::System.Exception? Exception;
            public EchoMethodInvocationHistory(EchoArguments Arguments, T? Result, global::System.Exception? Exception)
            {
                this.Arguments = Arguments;
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches(EchoArgumentsCriteria criteria)
            {
                return criteria.Matches(Arguments);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class EchoMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IEchoMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IEchoMethodInvocationHistory>();
            internal void Add(IEchoMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count(EchoArgumentsCriteria argumentsCriteria)
            {
                return _invocationHistory.Count(it => it.Matches(argumentsCriteria));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class EchoMethodInvocationImposterGroup
        {
            internal static EchoMethodInvocationImposterGroup Default = new EchoMethodInvocationImposterGroup(new EchoArgumentsCriteria(global::Imposter.Abstractions.Arg<T>.Any()));
            internal EchoArgumentsCriteria ArgumentsCriteria { get; }

            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public EchoMethodInvocationImposterGroup(EchoArgumentsCriteria argumentsCriteria)
            {
                ArgumentsCriteria = argumentsCriteria;
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public T Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, T value, EchoDelegate? baseImplementation = null)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, value, baseImplementation);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private EchoDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<EchoCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<EchoCallbackDelegate>();
                private bool _useBaseImplementation;
                internal bool IsEmpty => !_useBaseImplementation && ((_resultGenerator == null) && (_callbacks.Count == 0));

                public T Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, T value, EchoDelegate? baseImplementation = null)
                {
                    if (_useBaseImplementation)
                    {
                        _resultGenerator = baseImplementation ?? throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    T result = _resultGenerator.Invoke(value);
                    foreach (var callback in _callbacks)
                    {
                        callback(value);
                    }

                    return result;
                }

                internal void Callback(EchoCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(EchoDelegate resultGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(T value_1)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = (T value) =>
                    {
                        return value_1;
                    };
                }

                internal void Throws(EchoExceptionGeneratorDelegate exceptionGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = (T value) =>
                    {
                        throw exceptionGenerator(value);
                    };
                }

                internal void UseBaseImplementation()
                {
                    _useBaseImplementation = true;
                    _resultGenerator = null;
                }

                internal static T DefaultResultGenerator(T value)
                {
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IEchoMethodInvocationImposterGroupCallback
        {
            IEchoMethodInvocationImposterGroupContinuation Callback(EchoCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IEchoMethodInvocationImposterGroupContinuation : IEchoMethodInvocationImposterGroupCallback
        {
            IEchoMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IEchoMethodInvocationImposterGroup : IEchoMethodInvocationImposterGroupCallback
        {
            IEchoMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IEchoMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IEchoMethodInvocationImposterGroupContinuation Throws(EchoExceptionGeneratorDelegate exceptionGenerator);
            IEchoMethodInvocationImposterGroupContinuation Returns(EchoDelegate resultGenerator);
            IEchoMethodInvocationImposterGroupContinuation Returns(T value);
            IEchoMethodInvocationImposterGroupContinuation UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface EchoInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IEchoMethodImposterBuilder : IEchoMethodInvocationImposterGroup, IEchoMethodInvocationImposterGroupCallback, EchoInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class EchoMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<EchoMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<EchoMethodInvocationImposterGroup>();
            private readonly EchoMethodInvocationHistoryCollection _echoMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public EchoMethodImposter(EchoMethodInvocationHistoryCollection _echoMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._echoMethodInvocationHistoryCollection = _echoMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup(EchoArguments arguments)
            {
                return FindMatchingInvocationImposterGroup(arguments) != null;
            }

            private EchoMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup(EchoArguments arguments)
            {
                foreach (var invocationImposterGroup in _invocationImposters)
                {
                    if (invocationImposterGroup.ArgumentsCriteria.Matches(arguments))
                        return invocationImposterGroup;
                }

                return null;
            }

            public T Invoke(T value, EchoDelegate? baseImplementation = null)
            {
                var arguments = new EchoArguments(value);
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup(arguments);
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("virtual T OpenGenericClass<T>.Echo(T value)");
                    }

                    matchingInvocationImposterGroup = EchoMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "virtual T OpenGenericClass<T>.Echo(T value)", value, baseImplementation);
                    _echoMethodInvocationHistoryCollection.Add(new EchoMethodInvocationHistory(arguments, result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _echoMethodInvocationHistoryCollection.Add(new EchoMethodInvocationHistory(arguments, default !, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IEchoMethodImposterBuilder, IEchoMethodInvocationImposterGroupContinuation
            {
                private readonly EchoMethodImposter _imposter;
                private readonly EchoMethodInvocationHistoryCollection _echoMethodInvocationHistoryCollection;
                private readonly EchoArgumentsCriteria _argumentsCriteria;
                private readonly EchoMethodInvocationImposterGroup _invocationImposterGroup;
                private EchoMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(EchoMethodImposter _imposter, EchoMethodInvocationHistoryCollection _echoMethodInvocationHistoryCollection, EchoArgumentsCriteria _argumentsCriteria)
                {
                    this._imposter = _imposter;
                    this._echoMethodInvocationHistoryCollection = _echoMethodInvocationHistoryCollection;
                    this._argumentsCriteria = _argumentsCriteria;
                    this._invocationImposterGroup = new EchoMethodInvocationImposterGroup(_argumentsCriteria);
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IEchoMethodInvocationImposterGroupContinuation IEchoMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((T value) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IEchoMethodInvocationImposterGroupContinuation IEchoMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((T value) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IEchoMethodInvocationImposterGroupContinuation IEchoMethodInvocationImposterGroup.Throws(EchoExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((T value) =>
                    {
                        throw exceptionGenerator.Invoke(value);
                    });
                    return this;
                }

                IEchoMethodInvocationImposterGroupContinuation IEchoMethodInvocationImposterGroupCallback.Callback(EchoCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IEchoMethodInvocationImposterGroupContinuation IEchoMethodInvocationImposterGroup.Returns(EchoDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IEchoMethodInvocationImposterGroupContinuation IEchoMethodInvocationImposterGroup.Returns(T value_1)
                {
                    _currentInvocationImposter.Returns(value_1);
                    return this;
                }

                IEchoMethodInvocationImposterGroupContinuation IEchoMethodInvocationImposterGroup.UseBaseImplementation()
                {
                    _currentInvocationImposter.UseBaseImplementation();
                    return this;
                }

                IEchoMethodInvocationImposterGroup IEchoMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void EchoInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _echoMethodInvocationHistoryCollection.Count(_argumentsCriteria);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount);
                    }
                }
            }
        }

        public ICurrentPropertyBuilder Current => _CurrentPropertyBuilderField;

        private readonly CurrentPropertyBuilder _CurrentPropertyBuilderField;
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertyGetterOutcomeBuilder
        {
            ICurrentPropertyGetterContinuationBuilder Returns(T value);
            ICurrentPropertyGetterContinuationBuilder Returns(global::System.Func<T> valueGenerator);
            ICurrentPropertyGetterContinuationBuilder Throws(global::System.Exception exception);
            ICurrentPropertyGetterContinuationBuilder Throws<TException>()
                where TException : Exception, new();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertyGetterCallbackBuilder
        {
            ICurrentPropertyGetterContinuationBuilder Callback(global::System.Action callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertyGetterContinuationBuilder : ICurrentPropertyGetterCallbackBuilder
        {
            ICurrentPropertyGetterFluentBuilder Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertyGetterVerifier
        {
            void Called(global::Imposter.Abstractions.Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertyGetterFluentBuilder : ICurrentPropertyGetterOutcomeBuilder, ICurrentPropertyGetterContinuationBuilder
        {
            ICurrentPropertyGetterFluentBuilder UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertyGetterBuilder : ICurrentPropertyGetterOutcomeBuilder, ICurrentPropertyGetterCallbackBuilder, ICurrentPropertyGetterVerifier, ICurrentPropertyGetterUseBaseImplementationBuilder
        {
            ICurrentPropertyGetterUseBaseImplementationBuilder Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertyGetterUseBaseImplementationBuilder
        {
            ICurrentPropertyGetterFluentBuilder UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertySetterCallbackBuilder
        {
            ICurrentPropertySetterContinuationBuilder Callback(global::System.Action<T> callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertySetterContinuationBuilder : ICurrentPropertySetterCallbackBuilder
        {
            ICurrentPropertySetterUseBaseImplementationBuilder Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertySetterFluentBuilder : ICurrentPropertySetterCallbackBuilder, ICurrentPropertySetterContinuationBuilder
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertySetterVerifier
        {
            void Called(global::Imposter.Abstractions.Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertySetterBuilder : ICurrentPropertySetterCallbackBuilder, ICurrentPropertySetterVerifier, ICurrentPropertySetterUseBaseImplementationBuilder
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertySetterUseBaseImplementationBuilder : ICurrentPropertySetterFluentBuilder
        {
            ICurrentPropertySetterFluentBuilder UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ICurrentPropertyBuilder
        {
            ICurrentPropertyGetterBuilder Getter();
            ICurrentPropertySetterBuilder Setter(global::Imposter.Abstractions.Arg<T> criteria);
            ICurrentPropertyBuilder UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class CurrentPropertyBuilder : ICurrentPropertyBuilder
        {
            private readonly DefaultPropertyBehaviour _defaultPropertyBehaviour;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            internal SetterImposter _setterImposter;
            internal GetterImposterBuilder _getterImposterBuilder;
            internal CurrentPropertyBuilder(global::Imposter.Abstractions.ImposterMode invocationBehavior)
            {
                _defaultPropertyBehaviour = new DefaultPropertyBehaviour();
                _invocationBehavior = invocationBehavior;
                _getterImposterBuilder = new GetterImposterBuilder(_defaultPropertyBehaviour, _invocationBehavior, "Imposter.Tests.Features.OpenGenericImposter.OpenGenericClass<T>.Current");
                _setterImposter = new SetterImposter(_defaultPropertyBehaviour, _invocationBehavior, "Imposter.Tests.Features.OpenGenericImposter.OpenGenericClass<T>.Current");
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class DefaultPropertyBehaviour
            {
                internal bool IsOn = true;
                internal bool HasValueSet = false;
                internal T BackingField = default;
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class GetterImposterBuilder : ICurrentPropertyGetterBuilder, ICurrentPropertyGetterFluentBuilder, ICurrentPropertyGetterUseBaseImplementationBuilder
            {
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<global::System.Func<global::System.Func<T>?, T>> _returnValues = new global::System.Collections.Concurrent.ConcurrentQueue<global::System.Func<global::System.Func<T>?, T>>();
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<global::System.Action> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<global::System.Action>();
                private volatile global::System.Func<global::System.Func<T>?, T> _lastReturnValue = _ => default !;
                private int _invocationCount;
                private readonly DefaultPropertyBehaviour _defaultPropertyBehaviour;
                private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
                private readonly string _propertyDisplayName;
                private bool _hasConfiguredReturn;
                internal GetterImposterBuilder(DefaultPropertyBehaviour _defaultPropertyBehaviour, global::Imposter.Abstractions.ImposterMode invocationBehavior, string propertyDisplayName)
                {
                    this._defaultPropertyBehaviour = _defaultPropertyBehaviour;
                    this._invocationBehavior = invocationBehavior;
                    this._propertyDisplayName = propertyDisplayName;
                }

                private void AddReturnValue(global::System.Func<global::System.Func<T>?, T> valueGenerator)
                {
                    _defaultPropertyBehaviour.IsOn = false;
                    _returnValues.Enqueue(valueGenerator);
                    _hasConfiguredReturn = true;
                }

                ICurrentPropertyGetterContinuationBuilder ICurrentPropertyGetterOutcomeBuilder.Returns(T value)
                {
                    AddReturnValue((_) => value);
                    return this;
                }

                ICurrentPropertyGetterContinuationBuilder ICurrentPropertyGetterOutcomeBuilder.Returns(global::System.Func<T> valueGenerator)
                {
                    AddReturnValue((_) => valueGenerator());
                    return this;
                }

                ICurrentPropertyGetterContinuationBuilder ICurrentPropertyGetterOutcomeBuilder.Throws(global::System.Exception exception)
                {
                    AddReturnValue((_) => throw exception);
                    return this;
                }

                ICurrentPropertyGetterContinuationBuilder ICurrentPropertyGetterOutcomeBuilder.Throws<TException>()
                {
                    AddReturnValue((_) => throw new TException());
                    return this;
                }

                ICurrentPropertyGetterContinuationBuilder ICurrentPropertyGetterCallbackBuilder.Callback(global::System.Action callback)
                {
                    _callbacks.Enqueue(callback);
                    return this;
                }

                void ICurrentPropertyGetterVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    if (!count.Matches(_invocationCount))
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, _invocationCount);
                }

                ICurrentPropertyGetterFluentBuilder ICurrentPropertyGetterContinuationBuilder.Then()
                {
                    return this;
                }

                ICurrentPropertyGetterUseBaseImplementationBuilder ICurrentPropertyGetterBuilder.Then()
                {
                    return this;
                }

                internal void EnableBaseImplementation()
                {
                    AddReturnValue((global::System.Func<T>? baseImplementation) =>
                    {
                        if (baseImplementation != null)
                            return baseImplementation();
                        else
                            throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (getter)");
                    });
                }

                ICurrentPropertyGetterFluentBuilder ICurrentPropertyGetterUseBaseImplementationBuilder.UseBaseImplementation()
                {
                    EnableBaseImplementation();
                    return this;
                }

                ICurrentPropertyGetterFluentBuilder ICurrentPropertyGetterFluentBuilder.UseBaseImplementation()
                {
                    EnableBaseImplementation();
                    return this;
                }

                internal T Get(global::System.Func<T>? baseImplementation = null)
                {
                    EnsureGetterConfigured();
                    global::System.Threading.Interlocked.Increment(ref _invocationCount);
                    foreach (var getterCallback in _callbacks)
                    {
                        getterCallback();
                    }

                    if (_defaultPropertyBehaviour.IsOn)
                    {
                        if (((_invocationCount == 1) && (baseImplementation != null)) && !_defaultPropertyBehaviour.HasValueSet)
                        {
                            _defaultPropertyBehaviour.BackingField = baseImplementation();
                        }

                        return _defaultPropertyBehaviour.BackingField;
                    }

                    var nextReturnValue = _lastReturnValue;
                    if (_returnValues.TryDequeue(out var returnValue) && (returnValue != null))
                    {
                        nextReturnValue = returnValue;
                        _lastReturnValue = returnValue;
                    }

                    return nextReturnValue(baseImplementation);
                }

                private void EnsureGetterConfigured()
                {
                    if ((_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit) && !_hasConfiguredReturn)
                        throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (getter)");
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class SetterImposter
            {
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<global::System.Tuple<global::Imposter.Abstractions.Arg<T>, global::System.Action<T>>> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<global::System.Tuple<global::Imposter.Abstractions.Arg<T>, global::System.Action<T>>>();
                private readonly global::System.Collections.Concurrent.ConcurrentBag<T> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentBag<T>();
                private readonly DefaultPropertyBehaviour _defaultPropertyBehaviour;
                private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
                private readonly string _propertyDisplayName;
                private bool _hasConfiguredSetter;
                private bool _useBaseImplementation;
                internal SetterImposter(DefaultPropertyBehaviour _defaultPropertyBehaviour, global::Imposter.Abstractions.ImposterMode invocationBehavior, string propertyDisplayName)
                {
                    this._defaultPropertyBehaviour = _defaultPropertyBehaviour;
                    this._invocationBehavior = invocationBehavior;
                    this._propertyDisplayName = propertyDisplayName;
                }

                internal void Callback(global::Imposter.Abstractions.Arg<T> criteria, global::System.Action<T> callback)
                {
                    _callbacks.Enqueue(new global::System.Tuple<global::Imposter.Abstractions.Arg<T>, global::System.Action<T>>(criteria, callback));
                }

                void Called(global::Imposter.Abstractions.Arg<T> criteria, global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _invocationHistory.Count(criteria.Matches);
                    if (!count.Matches(invocationCount))
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount);
                }

                internal void UseBaseImplementation()
                {
                    _hasConfiguredSetter = true;
                    _useBaseImplementation = true;
                }

                internal void Set(T value, global::System.Action<T>? baseImplementation = null)
                {
                    EnsureSetterConfigured();
                    _invocationHistory.Add(value);
                    foreach (var(criteria, setterCallback)in _callbacks)
                    {
                        if (criteria.Matches(value))
                            setterCallback(value);
                    }

                    if (_useBaseImplementation)
                    {
                        if (baseImplementation != null)
                        {
                            baseImplementation(value);
                            return;
                        }
                        else
                            throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (setter)");
                    }

                    if (_defaultPropertyBehaviour.IsOn)
                    {
                        _defaultPropertyBehaviour.BackingField = value;
                        _defaultPropertyBehaviour.HasValueSet = true;
                    }
                }

                private void EnsureSetterConfigured()
                {
                    if ((_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit) && !_hasConfiguredSetter)
                        throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (setter)");
                }

                internal void MarkConfigured()
                {
                    _hasConfiguredSetter = true;
                }

                [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
                internal class Builder : ICurrentPropertySetterBuilder, ICurrentPropertySetterFluentBuilder, ICurrentPropertySetterUseBaseImplementationBuilder
                {
                    private readonly SetterImposter _setterImposter;
                    private readonly global::Imposter.Abstractions.Arg<T> _criteria;
                    internal Builder(SetterImposter _setterImposter, global::Imposter.Abstractions.Arg<T> _criteria)
                    {
                        this._setterImposter = _setterImposter;
                        this._criteria = _criteria;
                    }

                    ICurrentPropertySetterContinuationBuilder ICurrentPropertySetterCallbackBuilder.Callback(global::System.Action<T> callback)
                    {
                        _setterImposter.Callback(_criteria, callback);
                        return this;
                    }

                    void ICurrentPropertySetterVerifier.Called(global::Imposter.Abstractions.Count count)
                    {
                        _setterImposter.Called(_criteria, count);
                    }

                    ICurrentPropertySetterUseBaseImplementationBuilder ICurrentPropertySetterContinuationBuilder.Then()
                    {
                        return this;
                    }

                    ICurrentPropertySetterFluentBuilder ICurrentPropertySetterUseBaseImplementationBuilder.UseBaseImplementation()
                    {
                        _setterImposter.UseBaseImplementation();
                        return this;
                    }
                }
            }

            ICurrentPropertyGetterBuilder ICurrentPropertyBuilder.Getter()
            {
                return _getterImposterBuilder;
            }

            ICurrentPropertySetterBuilder ICurrentPropertyBuilder.Setter(global::Imposter.Abstractions.Arg<T> criteria)
            {
                _setterImposter.MarkConfigured();
                return new SetterImposter.Builder(_setterImposter, criteria);
            }

            ICurrentPropertyBuilder ICurrentPropertyBuilder.UseBaseImplementation()
            {
                _getterImposterBuilder.EnableBaseImplementation();
                _setterImposter.UseBaseImplementation();
                return this;
            }
        }

        public IValueChangedEventImposterBuilder ValueChanged => _ValueChanged;

        private readonly ValueChangedEventImposterBuilder _ValueChanged;
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IValueChangedEventImposterBuilder : IValueChangedEventImposterSetupBuilder, IValueChangedEventImposterVerificationBuilder
        {
            IValueChangedEventImposterBuilder UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IValueChangedEventImposterSetupBuilder
        {
            IValueChangedEventImposterSetupBuilder Callback(global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>> callback);
            IValueChangedEventImposterSetupBuilder Raise(object sender, global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T> e);
            IValueChangedEventImposterSetupBuilder OnSubscribe(global::System.Action<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> interceptor);
            IValueChangedEventImposterSetupBuilder OnUnsubscribe(global::System.Action<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> interceptor);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IValueChangedEventImposterVerificationBuilder
        {
            IValueChangedEventImposterVerificationBuilder Subscribed(global::Imposter.Abstractions.Arg<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> criteria, global::Imposter.Abstractions.Count count);
            IValueChangedEventImposterVerificationBuilder Unsubscribed(global::Imposter.Abstractions.Arg<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> criteria, global::Imposter.Abstractions.Count count);
            IValueChangedEventImposterVerificationBuilder Raised(global::Imposter.Abstractions.Arg<object> senderCriteria, global::Imposter.Abstractions.Arg<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>> eCriteria, global::Imposter.Abstractions.Count count);
            IValueChangedEventImposterVerificationBuilder HandlerInvoked(global::Imposter.Abstractions.Arg<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> handlerCriteria, global::Imposter.Abstractions.Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal sealed class ValueChangedEventImposterBuilder : IValueChangedEventImposterBuilder, IValueChangedEventImposterSetupBuilder, IValueChangedEventImposterVerificationBuilder
        {
            private readonly global::System.Collections.Concurrent.ConcurrentQueue<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> _handlerOrder = new global::System.Collections.Concurrent.ConcurrentQueue<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>>();
            private readonly global::System.Collections.Concurrent.ConcurrentDictionary<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>, int> _handlerCounts = new global::System.Collections.Concurrent.ConcurrentDictionary<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>, int>();
            private readonly global::System.Collections.Concurrent.ConcurrentQueue<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>>();
            private readonly global::System.Collections.Concurrent.ConcurrentQueue<(object sender, global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T> e)> _history = new global::System.Collections.Concurrent.ConcurrentQueue<(object sender, global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T> e)>();
            private readonly global::System.Collections.Concurrent.ConcurrentQueue<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> _subscribeHistory = new global::System.Collections.Concurrent.ConcurrentQueue<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>>();
            private readonly global::System.Collections.Concurrent.ConcurrentQueue<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> _unsubscribeHistory = new global::System.Collections.Concurrent.ConcurrentQueue<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>>();
            private readonly global::System.Collections.Concurrent.ConcurrentQueue<global::System.Action<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>>> _subscribeInterceptors = new global::System.Collections.Concurrent.ConcurrentQueue<global::System.Action<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>>>();
            private readonly global::System.Collections.Concurrent.ConcurrentQueue<global::System.Action<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>>> _unsubscribeInterceptors = new global::System.Collections.Concurrent.ConcurrentQueue<global::System.Action<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>>>();
            private readonly global::System.Collections.Concurrent.ConcurrentQueue<(global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>> Handler, object sender, global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T> e)> _handlerInvocations = new global::System.Collections.Concurrent.ConcurrentQueue<(global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>> Handler, object sender, global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T> e)>();
            private bool _useBaseImplementation;
            private readonly string _eventDisplayName = "Imposter.Tests.Features.OpenGenericImposter.OpenGenericClass<T>.ValueChanged";
            internal ValueChangedEventImposterBuilder()
            {
            }

            internal void Subscribe(global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>> handler, global::System.Action? baseImplementation = null)
            {
                ArgumentNullException.ThrowIfNull(handler);
                _handlerOrder.Enqueue(handler);
                _handlerCounts.AddOrUpdate(handler, 1, (_, count) => count + 1);
                _subscribeHistory.Enqueue(handler);
                foreach (var interceptor in _subscribeInterceptors)
                {
                    interceptor(handler);
                }

                if (_useBaseImplementation)
                {
                    if (baseImplementation != null)
                    {
                        baseImplementation();
                    }
                    else
                        throw new global::Imposter.Abstractions.MissingImposterException(_eventDisplayName + " (event)");
                }
            }

            internal void Unsubscribe(global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>> handler, global::System.Action? baseImplementation = null)
            {
                ArgumentNullException.ThrowIfNull(handler);
                _handlerCounts.AddOrUpdate(handler, 0, (_, count) =>
                {
                    if (count > 0)
                    {
                        return count - 1;
                    }

                    return 0;
                });
                _unsubscribeHistory.Enqueue(handler);
                foreach (var interceptor in _unsubscribeInterceptors)
                {
                    interceptor(handler);
                }

                if (_useBaseImplementation)
                {
                    if (baseImplementation != null)
                    {
                        baseImplementation();
                    }
                    else
                        throw new global::Imposter.Abstractions.MissingImposterException(_eventDisplayName + " (event)");
                }
            }

            IValueChangedEventImposterSetupBuilder IValueChangedEventImposterSetupBuilder.Callback(global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>> callback)
            {
                ArgumentNullException.ThrowIfNull(callback);
                _callbacks.Enqueue(callback);
                return this;
            }

            IValueChangedEventImposterSetupBuilder IValueChangedEventImposterSetupBuilder.Raise(object sender, global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T> e)
            {
                RaiseInternal(sender, e);
                return this;
            }

            IValueChangedEventImposterVerificationBuilder IValueChangedEventImposterVerificationBuilder.Subscribed(global::Imposter.Abstractions.Arg<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> criteria, global::Imposter.Abstractions.Count count)
            {
                ArgumentNullException.ThrowIfNull(criteria);
                ArgumentNullException.ThrowIfNull(count);
                int actual = _subscribeHistory.Count(entry => criteria.Matches(entry));
                EnsureCountMatches(actual, count, "subscribed");
                return this;
            }

            IValueChangedEventImposterVerificationBuilder IValueChangedEventImposterVerificationBuilder.Unsubscribed(global::Imposter.Abstractions.Arg<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> criteria, global::Imposter.Abstractions.Count count)
            {
                ArgumentNullException.ThrowIfNull(criteria);
                ArgumentNullException.ThrowIfNull(count);
                int actual = _unsubscribeHistory.Count(entry => criteria.Matches(entry));
                EnsureCountMatches(actual, count, "unsubscribed");
                return this;
            }

            IValueChangedEventImposterSetupBuilder IValueChangedEventImposterSetupBuilder.OnSubscribe(global::System.Action<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> interceptor)
            {
                ArgumentNullException.ThrowIfNull(interceptor);
                _subscribeInterceptors.Enqueue(interceptor);
                return this;
            }

            IValueChangedEventImposterSetupBuilder IValueChangedEventImposterSetupBuilder.OnUnsubscribe(global::System.Action<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> interceptor)
            {
                ArgumentNullException.ThrowIfNull(interceptor);
                _unsubscribeInterceptors.Enqueue(interceptor);
                return this;
            }

            IValueChangedEventImposterVerificationBuilder IValueChangedEventImposterVerificationBuilder.Raised(global::Imposter.Abstractions.Arg<object> senderCriteria, global::Imposter.Abstractions.Arg<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>> eCriteria, global::Imposter.Abstractions.Count count)
            {
                ArgumentNullException.ThrowIfNull(senderCriteria);
                ArgumentNullException.ThrowIfNull(eCriteria);
                ArgumentNullException.ThrowIfNull(count);
                int actual = _history.Count(entry => senderCriteria.Matches(entry.sender) && eCriteria.Matches(entry.e));
                EnsureCountMatches(actual, count, "raised");
                return this;
            }

            IValueChangedEventImposterVerificationBuilder IValueChangedEventImposterVerificationBuilder.HandlerInvoked(global::Imposter.Abstractions.Arg<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> handlerCriteria, global::Imposter.Abstractions.Count count)
            {
                ArgumentNullException.ThrowIfNull(handlerCriteria);
                ArgumentNullException.ThrowIfNull(count);
                int actual = _handlerInvocations.Count(entry => handlerCriteria.Matches(entry.Handler));
                EnsureCountMatches(actual, count, "invoked");
                return this;
            }

            private void RaiseInternal(object sender, global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T> e)
            {
                _history.Enqueue((sender, e));
                foreach (var callback in _callbacks)
                {
                    callback(sender, e);
                }

                foreach (var handler in EnumerateActiveHandlers())
                {
                    _handlerInvocations.Enqueue((handler, sender, e));
                    handler(sender, e);
                }
            }

            private global::System.Collections.Generic.IEnumerable<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>> EnumerateActiveHandlers()
            {
                global::System.Collections.Generic.Dictionary<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>, int> budgets = new global::System.Collections.Generic.Dictionary<global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>, int>(_handlerCounts);
                foreach (var handler in _handlerOrder)
                {
                    int remaining;
                    if (budgets.TryGetValue(handler, out remaining))
                    {
                        if (remaining > 0)
                        {
                            budgets[handler] = remaining - 1;
                            yield return handler;
                        }
                    }
                }
            }

            private static void EnsureCountMatches(int actual, global::Imposter.Abstractions.Count expected, string action)
            {
                if (!expected.Matches(actual))
                {
                    throw new global::Imposter.Abstractions.VerificationFailedException(expected, actual);
                }
            }

            IValueChangedEventImposterBuilder IValueChangedEventImposterBuilder.UseBaseImplementation()
            {
                _useBaseImplementation = true;
                return this;
            }
        }

        private readonly IndexerIndexerBuilder _IndexerIndexer;
        public IIndexerIndexerBuilder this[global::Imposter.Abstractions.Arg<int> index] => new IndexerIndexerBuilder.InvocationBuilder(_IndexerIndexer, new IndexerIndexerArgumentsCriteria(index));
        public delegate T IndexerIndexerDelegate(int index);
        public delegate void IndexerIndexerGetterCallback(int index);
        public delegate void IndexerIndexerSetterCallback(int index, T value);
        public delegate global::System.Exception IndexerIndexerExceptionGenerator(int index);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class IndexerIndexerArguments : global::System.IEquatable<IndexerIndexerArguments>
        {
            public int index;
            internal IndexerIndexerArguments(int index)
            {
                this.index = index;
            }

            public bool Equals(IndexerIndexerArguments? other)
            {
                if (other == null)
                {
                    return false;
                }

                return true && (index == other.index);
            }

            public override bool Equals(object? obj)
            {
                return obj is IndexerIndexerArguments other && Equals(other);
            }

            public override int GetHashCode()
            {
                global::System.HashCode hash = new global::System.HashCode();
                hash.Add(index);
                return hash.ToHashCode();
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class IndexerIndexerArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<int> index;
            internal IndexerIndexerArgumentsCriteria(global::Imposter.Abstractions.Arg<int> index)
            {
                this.index = index;
            }

            public bool Matches(IndexerIndexerArguments arguments)
            {
                return index.Matches(arguments.index);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class IndexerIndexerBuilder
        {
            private readonly DefaultIndexerIndexerBehaviour _IndexerDefaultIndexerBehaviour = new DefaultIndexerIndexerBehaviour();
            private readonly GetterImposter _getterImposter;
            private readonly SetterImposter _setterImposter;
            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class DefaultIndexerIndexerBehaviour
            {
                private bool _isOn = true;
                internal bool IsOn
                {
                    get
                    {
                        return global::System.Threading.Volatile.Read(ref _isOn);
                    }

                    set
                    {
                        global::System.Threading.Volatile.Write(ref _isOn, value);
                    }
                }

                internal global::System.Collections.Concurrent.ConcurrentDictionary<IndexerIndexerArguments, T> BackingField = new global::System.Collections.Concurrent.ConcurrentDictionary<IndexerIndexerArguments, T>();
                internal T Get(IndexerIndexerArguments arguments, global::System.Func<T>? baseImplementation = null)
                {
                    T value = default(T);
                    if (BackingField.TryGetValue(arguments, out value))
                        return value;
                    if (baseImplementation != null)
                        return baseImplementation();
                    return default(T);
                }

                internal void Set(IndexerIndexerArguments arguments, T value, global::System.Action? baseImplementation = null)
                {
                    if (baseImplementation != null)
                    {
                        baseImplementation();
                        return;
                    }

                    BackingField[arguments] = value;
                }
            }

            internal IndexerIndexerBuilder(global::Imposter.Abstractions.ImposterMode invocationBehavior, string propertyDisplayName)
            {
                this._getterImposter = new GetterImposter(_IndexerDefaultIndexerBehaviour, invocationBehavior, propertyDisplayName);
                this._setterImposter = new SetterImposter(_IndexerDefaultIndexerBehaviour, invocationBehavior, propertyDisplayName);
            }

            internal IIndexerIndexerGetterBuilder CreateGetter(IndexerIndexerArgumentsCriteria criteria)
            {
                return new GetterImposter.Builder(_getterImposter, criteria);
            }

            internal IIndexerIndexerSetterBuilder CreateSetter(IndexerIndexerArgumentsCriteria criteria)
            {
                _setterImposter.MarkConfigured();
                return new SetterImposter.Builder(_setterImposter, criteria);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class InvocationBuilder : IIndexerIndexerBuilder
            {
                private readonly IndexerIndexerBuilder _builder;
                private readonly IndexerIndexerArgumentsCriteria _criteria;
                internal InvocationBuilder(IndexerIndexerBuilder builder, IndexerIndexerArgumentsCriteria criteria)
                {
                    this._builder = builder;
                    this._criteria = criteria;
                }

                public IIndexerIndexerGetterBuilder Getter()
                {
                    return _builder.CreateGetter(_criteria);
                }

                public IIndexerIndexerSetterBuilder Setter()
                {
                    return _builder.CreateSetter(_criteria);
                }
            }

            internal T Get(int index, global::System.Func<T>? baseImplementation = null)
            {
                return _getterImposter.Get(index, baseImplementation);
            }

            internal void Set(int index, T value, global::System.Action? baseImplementation = null)
            {
                _setterImposter.Set(index, value, baseImplementation);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            private sealed class GetterImposter
            {
                private readonly DefaultIndexerIndexerBehaviour _defaultBehaviour;
                private readonly global::System.Collections.Concurrent.ConcurrentStack<GetterInvocationImposter> _getterInvocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<GetterInvocationImposter>();
                private readonly global::System.Collections.Concurrent.ConcurrentDictionary<IndexerIndexerArgumentsCriteria, GetterInvocationImposter> _setupLookup = new global::System.Collections.Concurrent.ConcurrentDictionary<IndexerIndexerArgumentsCriteria, GetterInvocationImposter>();
                private readonly global::System.Collections.Concurrent.ConcurrentBag<IndexerIndexerArguments> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentBag<IndexerIndexerArguments>();
                private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
                private readonly string _propertyDisplayName;
                private bool _hasConfiguredReturn;
                internal GetterImposter(DefaultIndexerIndexerBehaviour defaultBehaviour, global::Imposter.Abstractions.ImposterMode invocationBehavior, string propertyDisplayName)
                {
                    this._defaultBehaviour = defaultBehaviour;
                    this._invocationBehavior = invocationBehavior;
                    this._propertyDisplayName = propertyDisplayName;
                }

                internal T Get(int index, global::System.Func<T>? baseImplementation = null)
                {
                    IndexerIndexerArguments arguments = new IndexerIndexerArguments(index);
                    try
                    {
                        var getterInvocationImposter = FindGetterInvocationImposter(arguments);
                        if (getterInvocationImposter is null)
                        {
                            EnsureGetterConfigured();
                            if (_defaultBehaviour.IsOn)
                                return _defaultBehaviour.Get(arguments, baseImplementation);
                            if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                            {
                                throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (getter)");
                            }
                            else
                            {
                                return default(T);
                            }
                        }

                        return getterInvocationImposter.Invoke(arguments, baseImplementation);
                    }
                    finally
                    {
                        _invocationHistory.Add(arguments);
                    }
                }

                private GetterInvocationImposter? FindGetterInvocationImposter(IndexerIndexerArguments arguments)
                {
                    foreach (var getterInvocationImposter in _getterInvocationImposters)
                    {
                        if (getterInvocationImposter.Criteria.Matches(arguments))
                        {
                            return getterInvocationImposter;
                        }
                    }

                    return null;
                }

                private GetterInvocationImposter GetOrCreate(IndexerIndexerArgumentsCriteria criteria)
                {
                    return _setupLookup.GetOrAdd(criteria, CreateSetup);
                    GetterInvocationImposter CreateSetup(IndexerIndexerArgumentsCriteria key)
                    {
                        GetterInvocationImposter getterInvocationImposter = new GetterInvocationImposter(this, _defaultBehaviour, key);
                        _getterInvocationImposters.Push(getterInvocationImposter);
                        return getterInvocationImposter;
                    }
                }

                private void Called(IndexerIndexerArgumentsCriteria criteria, global::Imposter.Abstractions.Count count)
                {
                    int invocationCount = _invocationHistory.Count(criteria.Matches);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount);
                    }
                }

                internal string PropertyDisplayName => _propertyDisplayName;

                internal void MarkReturnConfigured()
                {
                    global::System.Threading.Volatile.Write(ref _hasConfiguredReturn, true);
                }

                private void EnsureGetterConfigured()
                {
                    if ((_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit) && !global::System.Threading.Volatile.Read(ref _hasConfiguredReturn))
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (getter)");
                    }
                }

                [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
                internal class Builder : IIndexerIndexerGetterBuilder, IIndexerIndexerGetterFluentBuilder
                {
                    private readonly GetterImposter _imposter;
                    private readonly IndexerIndexerArgumentsCriteria _criteria;
                    internal Builder(GetterImposter _imposter, IndexerIndexerArgumentsCriteria _criteria)
                    {
                        this._imposter = _imposter;
                        this._criteria = _criteria;
                    }

                    private GetterInvocationImposter InvocationImposter => _imposter.GetOrCreate(_criteria);

                    IIndexerIndexerGetterContinuationBuilder IIndexerIndexerGetterOutcomeBuilder.Returns(T value)
                    {
                        InvocationImposter.AddReturnValue(arguments => value);
                        return this;
                    }

                    IIndexerIndexerGetterContinuationBuilder IIndexerIndexerGetterOutcomeBuilder.Returns(global::System.Func<T> valueGenerator)
                    {
                        InvocationImposter.AddReturnValue(arguments => valueGenerator());
                        return this;
                    }

                    IIndexerIndexerGetterContinuationBuilder IIndexerIndexerGetterOutcomeBuilder.Returns(IndexerIndexerDelegate valueGenerator)
                    {
                        InvocationImposter.AddReturnValue(arguments => valueGenerator(arguments.index));
                        return this;
                    }

                    IIndexerIndexerGetterContinuationBuilder IIndexerIndexerGetterOutcomeBuilder.Throws(global::System.Exception exception)
                    {
                        InvocationImposter.AddReturnValue(arguments => throw exception);
                        return this;
                    }

                    IIndexerIndexerGetterContinuationBuilder IIndexerIndexerGetterOutcomeBuilder.Throws<TException>()
                    {
                        InvocationImposter.AddReturnValue(arguments => throw new TException());
                        return this;
                    }

                    IIndexerIndexerGetterContinuationBuilder IIndexerIndexerGetterOutcomeBuilder.Throws(IndexerIndexerExceptionGenerator exceptionGenerator)
                    {
                        InvocationImposter.AddReturnValue(arguments => throw exceptionGenerator(arguments.index));
                        return this;
                    }

                    IIndexerIndexerGetterContinuationBuilder IIndexerIndexerGetterCallbackBuilder.Callback(IndexerIndexerGetterCallback callback)
                    {
                        InvocationImposter.AddCallback(callback);
                        return this;
                    }

                    void IIndexerIndexerGetterVerifier.Called(global::Imposter.Abstractions.Count count)
                    {
                        _imposter.Called(_criteria, count);
                    }

                    IIndexerIndexerGetterFluentBuilder IIndexerIndexerGetterContinuationBuilder.Then()
                    {
                        return this;
                    }

                    IIndexerIndexerGetterContinuationBuilder IIndexerIndexerGetterOutcomeBuilder.UseBaseImplementation()
                    {
                        InvocationImposter.UseBaseImplementation();
                        return this;
                    }
                }

                [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
                private sealed class GetterInvocationImposter
                {
                    private readonly GetterImposter _parent;
                    private readonly DefaultIndexerIndexerBehaviour _defaultBehaviour;
                    private readonly global::System.Collections.Concurrent.ConcurrentQueue<global::System.Func<IndexerIndexerArguments, global::System.Func<T>?, T>> _returnValues = new global::System.Collections.Concurrent.ConcurrentQueue<global::System.Func<IndexerIndexerArguments, global::System.Func<T>?, T>>();
                    private readonly global::System.Collections.Concurrent.ConcurrentQueue<IndexerIndexerGetterCallback> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<IndexerIndexerGetterCallback>();
                    private volatile global::System.Func<IndexerIndexerArguments, global::System.Func<T>?, T>? _lastReturnValue;
                    private int _invocationCount;
                    private string _propertyDisplayName;
                    internal IndexerIndexerArgumentsCriteria Criteria { get; private set; }
                    internal int InvocationCount => global::System.Threading.Volatile.Read(ref _invocationCount);

                    internal GetterInvocationImposter(GetterImposter parent, DefaultIndexerIndexerBehaviour defaultBehaviour, IndexerIndexerArgumentsCriteria criteria)
                    {
                        this._parent = parent;
                        this._defaultBehaviour = defaultBehaviour;
                        this._propertyDisplayName = parent.PropertyDisplayName;
                        this.Criteria = criteria;
                    }

                    internal void AddReturnValue(global::System.Func<IndexerIndexerArguments, T> generator)
                    {
                        _defaultBehaviour.IsOn = false;
                        _returnValues.Enqueue((arguments, baseImplementation) => generator(arguments));
                        _parent.MarkReturnConfigured();
                    }

                    internal void AddCallback(IndexerIndexerGetterCallback callback)
                    {
                        _callbacks.Enqueue(callback);
                    }

                    internal T Invoke(IndexerIndexerArguments arguments, global::System.Func<T>? baseImplementation = null)
                    {
                        global::System.Threading.Interlocked.Increment(ref _invocationCount);
                        foreach (var callback in _callbacks)
                        {
                            callback(arguments.index);
                        }

                        global::System.Func<IndexerIndexerArguments, global::System.Func<T>?, T> generator = ResolveNextGenerator(arguments);
                        return generator(arguments, baseImplementation);
                    }

                    private global::System.Func<IndexerIndexerArguments, global::System.Func<T>?, T> ResolveNextGenerator(IndexerIndexerArguments arguments)
                    {
                        if (_defaultBehaviour.IsOn)
                        {
                            return (arguments, baseImplementation) => _defaultBehaviour.Get(arguments, baseImplementation);
                        }

                        _returnValues.TryDequeue(out var returnValue);
                        var nextReturnValue = returnValue ?? _lastReturnValue;
                        if (nextReturnValue == null)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (getter)");
                        }

                        _lastReturnValue = nextReturnValue;
                        return nextReturnValue!;
                    }

                    internal void UseBaseImplementation()
                    {
                        _parent.MarkReturnConfigured();
                        _defaultBehaviour.IsOn = false;
                        _returnValues.Enqueue((arguments, baseImplementation) =>
                        {
                            if (baseImplementation == null)
                            {
                                throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (getter)");
                            }

                            return baseImplementation();
                        });
                        _lastReturnValue = null;
                    }
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            private sealed class SetterImposter
            {
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<(IndexerIndexerArgumentsCriteria Criteria, IndexerIndexerSetterCallback Callback)> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<(IndexerIndexerArgumentsCriteria Criteria, IndexerIndexerSetterCallback Callback)>();
                private readonly global::System.Collections.Concurrent.ConcurrentBag<IndexerIndexerArguments> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentBag<IndexerIndexerArguments>();
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<IndexerIndexerArgumentsCriteria> _baseCriteria = new global::System.Collections.Concurrent.ConcurrentQueue<IndexerIndexerArgumentsCriteria>();
                private readonly DefaultIndexerIndexerBehaviour _defaultBehaviour;
                private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
                private readonly string _propertyDisplayName;
                private bool _hasConfiguredSetter;
                internal SetterImposter(DefaultIndexerIndexerBehaviour defaultBehaviour, global::Imposter.Abstractions.ImposterMode invocationBehavior, string propertyDisplayName)
                {
                    this._defaultBehaviour = defaultBehaviour;
                    this._invocationBehavior = invocationBehavior;
                    this._propertyDisplayName = propertyDisplayName;
                }

                public void Callback(IndexerIndexerArgumentsCriteria criteria, IndexerIndexerSetterCallback callback)
                {
                    _callbacks.Enqueue((criteria, callback));
                }

                public void Called(IndexerIndexerArgumentsCriteria criteria, global::Imposter.Abstractions.Count count)
                {
                    int invocationCount = _invocationHistory.Count(criteria.Matches);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount);
                    }
                }

                internal void Set(int index, T value, global::System.Action? baseImplementation = null)
                {
                    EnsureSetterConfigured();
                    IndexerIndexerArguments arguments = new IndexerIndexerArguments(index);
                    _invocationHistory.Add(arguments);
                    bool matchedCallback = false;
                    foreach (var registration in _callbacks)
                    {
                        if (registration.Criteria.Matches(arguments))
                        {
                            registration.Callback(arguments.index, value);
                            matchedCallback = true;
                        }
                    }

                    bool invokedBaseImplementation = false;
                    foreach (var criteria in _baseCriteria)
                    {
                        if (criteria.Matches(arguments))
                        {
                            if (baseImplementation == null)
                            {
                                throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (setter)");
                            }

                            baseImplementation();
                            invokedBaseImplementation = true;
                            break;
                        }
                    }

                    if (!invokedBaseImplementation && (!matchedCallback && _defaultBehaviour.IsOn))
                    {
                        _defaultBehaviour.Set(arguments, value, null);
                    }
                }

                private void EnsureSetterConfigured()
                {
                    if ((_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit) && !global::System.Threading.Volatile.Read(ref _hasConfiguredSetter))
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (setter)");
                    }
                }

                internal void MarkConfigured()
                {
                    global::System.Threading.Volatile.Write(ref _hasConfiguredSetter, true);
                }

                public void UseBaseImplementation(IndexerIndexerArgumentsCriteria criteria)
                {
                    _baseCriteria.Enqueue(criteria);
                    MarkConfigured();
                }

                [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
                internal class Builder : IIndexerIndexerSetterBuilder, IIndexerIndexerSetterFluentBuilder
                {
                    private readonly SetterImposter _setterImposter;
                    private readonly IndexerIndexerArgumentsCriteria _criteria;
                    internal Builder(SetterImposter _setterImposter, IndexerIndexerArgumentsCriteria _criteria)
                    {
                        this._setterImposter = _setterImposter;
                        this._criteria = _criteria;
                    }

                    IIndexerIndexerSetterContinuationBuilder IIndexerIndexerSetterCallbackBuilder.Callback(IndexerIndexerSetterCallback callback)
                    {
                        _setterImposter.Callback(_criteria, callback);
                        return this;
                    }

                    void IIndexerIndexerSetterVerifier.Called(global::Imposter.Abstractions.Count count)
                    {
                        _setterImposter.Called(_criteria, count);
                    }

                    IIndexerIndexerSetterFluentBuilder IIndexerIndexerSetterContinuationBuilder.Then()
                    {
                        return this;
                    }

                    IIndexerIndexerSetterFluentBuilder IIndexerIndexerSetterBuilder.UseBaseImplementation()
                    {
                        _setterImposter.UseBaseImplementation(_criteria);
                        return this;
                    }
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerGetterOutcomeBuilder
        {
            IIndexerIndexerGetterContinuationBuilder Returns(T value);
            IIndexerIndexerGetterContinuationBuilder Returns(global::System.Func<T> valueGenerator);
            IIndexerIndexerGetterContinuationBuilder Returns(IndexerIndexerDelegate valueGenerator);
            IIndexerIndexerGetterContinuationBuilder Throws(global::System.Exception exception);
            IIndexerIndexerGetterContinuationBuilder Throws<TException>()
                where TException : Exception, new();
            IIndexerIndexerGetterContinuationBuilder Throws(IndexerIndexerExceptionGenerator exceptionGenerator);
            IIndexerIndexerGetterContinuationBuilder UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerGetterCallbackBuilder
        {
            IIndexerIndexerGetterContinuationBuilder Callback(IndexerIndexerGetterCallback callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerGetterContinuationBuilder : IIndexerIndexerGetterCallbackBuilder
        {
            IIndexerIndexerGetterFluentBuilder Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerGetterVerifier
        {
            void Called(global::Imposter.Abstractions.Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerGetterFluentBuilder : IIndexerIndexerGetterOutcomeBuilder, IIndexerIndexerGetterContinuationBuilder
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerGetterBuilder : IIndexerIndexerGetterOutcomeBuilder, IIndexerIndexerGetterCallbackBuilder, IIndexerIndexerGetterVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerSetterCallbackBuilder
        {
            IIndexerIndexerSetterContinuationBuilder Callback(IndexerIndexerSetterCallback callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerSetterContinuationBuilder : IIndexerIndexerSetterCallbackBuilder
        {
            IIndexerIndexerSetterFluentBuilder Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerSetterFluentBuilder : IIndexerIndexerSetterCallbackBuilder, IIndexerIndexerSetterContinuationBuilder
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerSetterVerifier
        {
            void Called(global::Imposter.Abstractions.Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerSetterBuilder : IIndexerIndexerSetterCallbackBuilder, IIndexerIndexerSetterVerifier
        {
            IIndexerIndexerSetterFluentBuilder UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexerIndexerBuilder
        {
            IIndexerIndexerGetterBuilder Getter();
            IIndexerIndexerSetterBuilder Setter();
        }

        private readonly Indexer_1IndexerBuilder _Indexer_1Indexer;
        public IIndexer_1IndexerBuilder this[global::Imposter.Abstractions.Arg<T> key, global::Imposter.Abstractions.Arg<int> index] => new Indexer_1IndexerBuilder.InvocationBuilder(_Indexer_1Indexer, new Indexer_1IndexerArgumentsCriteria(key, index));
        public delegate T Indexer_1IndexerDelegate(T key, int index);
        public delegate void Indexer_1IndexerGetterCallback(T key, int index);
        public delegate void Indexer_1IndexerSetterCallback(T key, int index, T value);
        public delegate global::System.Exception Indexer_1IndexerExceptionGenerator(T key, int index);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class Indexer_1IndexerArguments : global::System.IEquatable<Indexer_1IndexerArguments>
        {
            public T key;
            public int index;
            internal Indexer_1IndexerArguments(T key, int index)
            {
                this.key = key;
                this.index = index;
            }

            public bool Equals(Indexer_1IndexerArguments? other)
            {
                if (other == null)
                {
                    return false;
                }

                return (true && (key == other.key)) && (index == other.index);
            }

            public override bool Equals(object? obj)
            {
                return obj is Indexer_1IndexerArguments other && Equals(other);
            }

            public override int GetHashCode()
            {
                global::System.HashCode hash = new global::System.HashCode();
                hash.Add(key);
                hash.Add(index);
                return hash.ToHashCode();
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class Indexer_1IndexerArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<T> key;
            public global::Imposter.Abstractions.Arg<int> index;
            internal Indexer_1IndexerArgumentsCriteria(global::Imposter.Abstractions.Arg<T> key, global::Imposter.Abstractions.Arg<int> index)
            {
                this.key = key;
                this.index = index;
            }

            public bool Matches(Indexer_1IndexerArguments arguments)
            {
                return key.Matches(arguments.key) && index.Matches(arguments.index);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class Indexer_1IndexerBuilder
        {
            private readonly DefaultIndexer_1IndexerBehaviour _Indexer_1DefaultIndexerBehaviour = new DefaultIndexer_1IndexerBehaviour();
            private readonly GetterImposter _getterImposter;
            private readonly SetterImposter _setterImposter;
            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class DefaultIndexer_1IndexerBehaviour
            {
                private bool _isOn = true;
                internal bool IsOn
                {
                    get
                    {
                        return global::System.Threading.Volatile.Read(ref _isOn);
                    }

                    set
                    {
                        global::System.Threading.Volatile.Write(ref _isOn, value);
                    }
                }

                internal global::System.Collections.Concurrent.ConcurrentDictionary<Indexer_1IndexerArguments, T> BackingField = new global::System.Collections.Concurrent.ConcurrentDictionary<Indexer_1IndexerArguments, T>();
                internal T Get(Indexer_1IndexerArguments arguments, global::System.Func<T>? baseImplementation = null)
                {
                    T value = default(T);
                    if (BackingField.TryGetValue(arguments, out value))
                        return value;
                    if (baseImplementation != null)
                        return baseImplementation();
                    return default(T);
                }

                internal void Set(Indexer_1IndexerArguments arguments, T value, global::System.Action? baseImplementation = null)
                {
                    if (baseImplementation != null)
                    {
                        baseImplementation();
                        return;
                    }

                    BackingField[arguments] = value;
                }
            }

            internal Indexer_1IndexerBuilder(global::Imposter.Abstractions.ImposterMode invocationBehavior, string propertyDisplayName)
            {
                this._getterImposter = new GetterImposter(_Indexer_1DefaultIndexerBehaviour, invocationBehavior, propertyDisplayName);
                this._setterImposter = new SetterImposter(_Indexer_1DefaultIndexerBehaviour, invocationBehavior, propertyDisplayName);
            }

            internal IIndexer_1IndexerGetterBuilder CreateGetter(Indexer_1IndexerArgumentsCriteria criteria)
            {
                return new GetterImposter.Builder(_getterImposter, criteria);
            }

            internal IIndexer_1IndexerSetterBuilder CreateSetter(Indexer_1IndexerArgumentsCriteria criteria)
            {
                _setterImposter.MarkConfigured();
                return new SetterImposter.Builder(_setterImposter, criteria);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class InvocationBuilder : IIndexer_1IndexerBuilder
            {
                private readonly Indexer_1IndexerBuilder _builder;
                private readonly Indexer_1IndexerArgumentsCriteria _criteria;
                internal InvocationBuilder(Indexer_1IndexerBuilder builder, Indexer_1IndexerArgumentsCriteria criteria)
                {
                    this._builder = builder;
                    this._criteria = criteria;
                }

                public IIndexer_1IndexerGetterBuilder Getter()
                {
                    return _builder.CreateGetter(_criteria);
                }

                public IIndexer_1IndexerSetterBuilder Setter()
                {
                    return _builder.CreateSetter(_criteria);
                }
            }

            internal T Get(T key, int index, global::System.Func<T>? baseImplementation = null)
            {
                return _getterImposter.Get(key, index, baseImplementation);
            }

            internal void Set(T key, int index, T value, global::System.Action? baseImplementation = null)
            {
                _setterImposter.Set(key, index, value, baseImplementation);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            private sealed class GetterImposter
            {
                private readonly DefaultIndexer_1IndexerBehaviour _defaultBehaviour;
                private readonly global::System.Collections.Concurrent.ConcurrentStack<GetterInvocationImposter> _getterInvocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<GetterInvocationImposter>();
                private readonly global::System.Collections.Concurrent.ConcurrentDictionary<Indexer_1IndexerArgumentsCriteria, GetterInvocationImposter> _setupLookup = new global::System.Collections.Concurrent.ConcurrentDictionary<Indexer_1IndexerArgumentsCriteria, GetterInvocationImposter>();
                private readonly global::System.Collections.Concurrent.ConcurrentBag<Indexer_1IndexerArguments> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentBag<Indexer_1IndexerArguments>();
                private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
                private readonly string _propertyDisplayName;
                private bool _hasConfiguredReturn;
                internal GetterImposter(DefaultIndexer_1IndexerBehaviour defaultBehaviour, global::Imposter.Abstractions.ImposterMode invocationBehavior, string propertyDisplayName)
                {
                    this._defaultBehaviour = defaultBehaviour;
                    this._invocationBehavior = invocationBehavior;
                    this._propertyDisplayName = propertyDisplayName;
                }

                internal T Get(T key, int index, global::System.Func<T>? baseImplementation = null)
                {
                    Indexer_1IndexerArguments arguments = new Indexer_1IndexerArguments(key, index);
                    try
                    {
                        var getterInvocationImposter = FindGetterInvocationImposter(arguments);
                        if (getterInvocationImposter is null)
                        {
                            EnsureGetterConfigured();
                            if (_defaultBehaviour.IsOn)
                                return _defaultBehaviour.Get(arguments, baseImplementation);
                            if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                            {
                                throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (getter)");
                            }
                            else
                            {
                                return default(T);
                            }
                        }

                        return getterInvocationImposter.Invoke(arguments, baseImplementation);
                    }
                    finally
                    {
                        _invocationHistory.Add(arguments);
                    }
                }

                private GetterInvocationImposter? FindGetterInvocationImposter(Indexer_1IndexerArguments arguments)
                {
                    foreach (var getterInvocationImposter in _getterInvocationImposters)
                    {
                        if (getterInvocationImposter.Criteria.Matches(arguments))
                        {
                            return getterInvocationImposter;
                        }
                    }

                    return null;
                }

                private GetterInvocationImposter GetOrCreate(Indexer_1IndexerArgumentsCriteria criteria)
                {
                    return _setupLookup.GetOrAdd(criteria, CreateSetup);
                    GetterInvocationImposter CreateSetup(Indexer_1IndexerArgumentsCriteria key)
                    {
                        GetterInvocationImposter getterInvocationImposter = new GetterInvocationImposter(this, _defaultBehaviour, key);
                        _getterInvocationImposters.Push(getterInvocationImposter);
                        return getterInvocationImposter;
                    }
                }

                private void Called(Indexer_1IndexerArgumentsCriteria criteria, global::Imposter.Abstractions.Count count)
                {
                    int invocationCount = _invocationHistory.Count(criteria.Matches);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount);
                    }
                }

                internal string PropertyDisplayName => _propertyDisplayName;

                internal void MarkReturnConfigured()
                {
                    global::System.Threading.Volatile.Write(ref _hasConfiguredReturn, true);
                }

                private void EnsureGetterConfigured()
                {
                    if ((_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit) && !global::System.Threading.Volatile.Read(ref _hasConfiguredReturn))
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (getter)");
                    }
                }

                [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
                internal class Builder : IIndexer_1IndexerGetterBuilder, IIndexer_1IndexerGetterFluentBuilder
                {
                    private readonly GetterImposter _imposter;
                    private readonly Indexer_1IndexerArgumentsCriteria _criteria;
                    internal Builder(GetterImposter _imposter, Indexer_1IndexerArgumentsCriteria _criteria)
                    {
                        this._imposter = _imposter;
                        this._criteria = _criteria;
                    }

                    private GetterInvocationImposter InvocationImposter => _imposter.GetOrCreate(_criteria);

                    IIndexer_1IndexerGetterContinuationBuilder IIndexer_1IndexerGetterOutcomeBuilder.Returns(T value)
                    {
                        InvocationImposter.AddReturnValue(arguments => value);
                        return this;
                    }

                    IIndexer_1IndexerGetterContinuationBuilder IIndexer_1IndexerGetterOutcomeBuilder.Returns(global::System.Func<T> valueGenerator)
                    {
                        InvocationImposter.AddReturnValue(arguments => valueGenerator());
                        return this;
                    }

                    IIndexer_1IndexerGetterContinuationBuilder IIndexer_1IndexerGetterOutcomeBuilder.Returns(Indexer_1IndexerDelegate valueGenerator)
                    {
                        InvocationImposter.AddReturnValue(arguments => valueGenerator(arguments.key, arguments.index));
                        return this;
                    }

                    IIndexer_1IndexerGetterContinuationBuilder IIndexer_1IndexerGetterOutcomeBuilder.Throws(global::System.Exception exception)
                    {
                        InvocationImposter.AddReturnValue(arguments => throw exception);
                        return this;
                    }

                    IIndexer_1IndexerGetterContinuationBuilder IIndexer_1IndexerGetterOutcomeBuilder.Throws<TException>()
                    {
                        InvocationImposter.AddReturnValue(arguments => throw new TException());
                        return this;
                    }

                    IIndexer_1IndexerGetterContinuationBuilder IIndexer_1IndexerGetterOutcomeBuilder.Throws(Indexer_1IndexerExceptionGenerator exceptionGenerator)
                    {
                        InvocationImposter.AddReturnValue(arguments => throw exceptionGenerator(arguments.key, arguments.index));
                        return this;
                    }

                    IIndexer_1IndexerGetterContinuationBuilder IIndexer_1IndexerGetterCallbackBuilder.Callback(Indexer_1IndexerGetterCallback callback)
                    {
                        InvocationImposter.AddCallback(callback);
                        return this;
                    }

                    void IIndexer_1IndexerGetterVerifier.Called(global::Imposter.Abstractions.Count count)
                    {
                        _imposter.Called(_criteria, count);
                    }

                    IIndexer_1IndexerGetterFluentBuilder IIndexer_1IndexerGetterContinuationBuilder.Then()
                    {
                        return this;
                    }

                    IIndexer_1IndexerGetterContinuationBuilder IIndexer_1IndexerGetterOutcomeBuilder.UseBaseImplementation()
                    {
                        InvocationImposter.UseBaseImplementation();
                        return this;
                    }
                }

                [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
                private sealed class GetterInvocationImposter
                {
                    private readonly GetterImposter _parent;
                    private readonly DefaultIndexer_1IndexerBehaviour _defaultBehaviour;
                    private readonly global::System.Collections.Concurrent.ConcurrentQueue<global::System.Func<Indexer_1IndexerArguments, global::System.Func<T>?, T>> _returnValues = new global::System.Collections.Concurrent.ConcurrentQueue<global::System.Func<Indexer_1IndexerArguments, global::System.Func<T>?, T>>();
                    private readonly global::System.Collections.Concurrent.ConcurrentQueue<Indexer_1IndexerGetterCallback> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<Indexer_1IndexerGetterCallback>();
                    private volatile global::System.Func<Indexer_1IndexerArguments, global::System.Func<T>?, T>? _lastReturnValue;
                    private int _invocationCount;
                    private string _propertyDisplayName;
                    internal Indexer_1IndexerArgumentsCriteria Criteria { get; private set; }
                    internal int InvocationCount => global::System.Threading.Volatile.Read(ref _invocationCount);

                    internal GetterInvocationImposter(GetterImposter parent, DefaultIndexer_1IndexerBehaviour defaultBehaviour, Indexer_1IndexerArgumentsCriteria criteria)
                    {
                        this._parent = parent;
                        this._defaultBehaviour = defaultBehaviour;
                        this._propertyDisplayName = parent.PropertyDisplayName;
                        this.Criteria = criteria;
                    }

                    internal void AddReturnValue(global::System.Func<Indexer_1IndexerArguments, T> generator)
                    {
                        _defaultBehaviour.IsOn = false;
                        _returnValues.Enqueue((arguments, baseImplementation) => generator(arguments));
                        _parent.MarkReturnConfigured();
                    }

                    internal void AddCallback(Indexer_1IndexerGetterCallback callback)
                    {
                        _callbacks.Enqueue(callback);
                    }

                    internal T Invoke(Indexer_1IndexerArguments arguments, global::System.Func<T>? baseImplementation = null)
                    {
                        global::System.Threading.Interlocked.Increment(ref _invocationCount);
                        foreach (var callback in _callbacks)
                        {
                            callback(arguments.key, arguments.index);
                        }

                        global::System.Func<Indexer_1IndexerArguments, global::System.Func<T>?, T> generator = ResolveNextGenerator(arguments);
                        return generator(arguments, baseImplementation);
                    }

                    private global::System.Func<Indexer_1IndexerArguments, global::System.Func<T>?, T> ResolveNextGenerator(Indexer_1IndexerArguments arguments)
                    {
                        if (_defaultBehaviour.IsOn)
                        {
                            return (arguments, baseImplementation) => _defaultBehaviour.Get(arguments, baseImplementation);
                        }

                        _returnValues.TryDequeue(out var returnValue);
                        var nextReturnValue = returnValue ?? _lastReturnValue;
                        if (nextReturnValue == null)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (getter)");
                        }

                        _lastReturnValue = nextReturnValue;
                        return nextReturnValue!;
                    }

                    internal void UseBaseImplementation()
                    {
                        _parent.MarkReturnConfigured();
                        _defaultBehaviour.IsOn = false;
                        _returnValues.Enqueue((arguments, baseImplementation) =>
                        {
                            if (baseImplementation == null)
                            {
                                throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (getter)");
                            }

                            return baseImplementation();
                        });
                        _lastReturnValue = null;
                    }
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            private sealed class SetterImposter
            {
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<(Indexer_1IndexerArgumentsCriteria Criteria, Indexer_1IndexerSetterCallback Callback)> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<(Indexer_1IndexerArgumentsCriteria Criteria, Indexer_1IndexerSetterCallback Callback)>();
                private readonly global::System.Collections.Concurrent.ConcurrentBag<Indexer_1IndexerArguments> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentBag<Indexer_1IndexerArguments>();
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<Indexer_1IndexerArgumentsCriteria> _baseCriteria = new global::System.Collections.Concurrent.ConcurrentQueue<Indexer_1IndexerArgumentsCriteria>();
                private readonly DefaultIndexer_1IndexerBehaviour _defaultBehaviour;
                private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
                private readonly string _propertyDisplayName;
                private bool _hasConfiguredSetter;
                internal SetterImposter(DefaultIndexer_1IndexerBehaviour defaultBehaviour, global::Imposter.Abstractions.ImposterMode invocationBehavior, string propertyDisplayName)
                {
                    this._defaultBehaviour = defaultBehaviour;
                    this._invocationBehavior = invocationBehavior;
                    this._propertyDisplayName = propertyDisplayName;
                }

                public void Callback(Indexer_1IndexerArgumentsCriteria criteria, Indexer_1IndexerSetterCallback callback)
                {
                    _callbacks.Enqueue((criteria, callback));
                }

                public void Called(Indexer_1IndexerArgumentsCriteria criteria, global::Imposter.Abstractions.Count count)
                {
                    int invocationCount = _invocationHistory.Count(criteria.Matches);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount);
                    }
                }

                internal void Set(T key, int index, T value, global::System.Action? baseImplementation = null)
                {
                    EnsureSetterConfigured();
                    Indexer_1IndexerArguments arguments = new Indexer_1IndexerArguments(key, index);
                    _invocationHistory.Add(arguments);
                    bool matchedCallback = false;
                    foreach (var registration in _callbacks)
                    {
                        if (registration.Criteria.Matches(arguments))
                        {
                            registration.Callback(arguments.key, arguments.index, value);
                            matchedCallback = true;
                        }
                    }

                    bool invokedBaseImplementation = false;
                    foreach (var criteria in _baseCriteria)
                    {
                        if (criteria.Matches(arguments))
                        {
                            if (baseImplementation == null)
                            {
                                throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (setter)");
                            }

                            baseImplementation();
                            invokedBaseImplementation = true;
                            break;
                        }
                    }

                    if (!invokedBaseImplementation && (!matchedCallback && _defaultBehaviour.IsOn))
                    {
                        _defaultBehaviour.Set(arguments, value, null);
                    }
                }

                private void EnsureSetterConfigured()
                {
                    if ((_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit) && !global::System.Threading.Volatile.Read(ref _hasConfiguredSetter))
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(_propertyDisplayName + " (setter)");
                    }
                }

                internal void MarkConfigured()
                {
                    global::System.Threading.Volatile.Write(ref _hasConfiguredSetter, true);
                }

                public void UseBaseImplementation(Indexer_1IndexerArgumentsCriteria criteria)
                {
                    _baseCriteria.Enqueue(criteria);
                    MarkConfigured();
                }

                [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
                internal class Builder : IIndexer_1IndexerSetterBuilder, IIndexer_1IndexerSetterFluentBuilder
                {
                    private readonly SetterImposter _setterImposter;
                    private readonly Indexer_1IndexerArgumentsCriteria _criteria;
                    internal Builder(SetterImposter _setterImposter, Indexer_1IndexerArgumentsCriteria _criteria)
                    {
                        this._setterImposter = _setterImposter;
                        this._criteria = _criteria;
                    }

                    IIndexer_1IndexerSetterContinuationBuilder IIndexer_1IndexerSetterCallbackBuilder.Callback(Indexer_1IndexerSetterCallback callback)
                    {
                        _setterImposter.Callback(_criteria, callback);
                        return this;
                    }

                    void IIndexer_1IndexerSetterVerifier.Called(global::Imposter.Abstractions.Count count)
                    {
                        _setterImposter.Called(_criteria, count);
                    }

                    IIndexer_1IndexerSetterFluentBuilder IIndexer_1IndexerSetterContinuationBuilder.Then()
                    {
                        return this;
                    }

                    IIndexer_1IndexerSetterFluentBuilder IIndexer_1IndexerSetterBuilder.UseBaseImplementation()
                    {
                        _setterImposter.UseBaseImplementation(_criteria);
                        return this;
                    }
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerGetterOutcomeBuilder
        {
            IIndexer_1IndexerGetterContinuationBuilder Returns(T value);
            IIndexer_1IndexerGetterContinuationBuilder Returns(global::System.Func<T> valueGenerator);
            IIndexer_1IndexerGetterContinuationBuilder Returns(Indexer_1IndexerDelegate valueGenerator);
            IIndexer_1IndexerGetterContinuationBuilder Throws(global::System.Exception exception);
            IIndexer_1IndexerGetterContinuationBuilder Throws<TException>()
                where TException : Exception, new();
            IIndexer_1IndexerGetterContinuationBuilder Throws(Indexer_1IndexerExceptionGenerator exceptionGenerator);
            IIndexer_1IndexerGetterContinuationBuilder UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerGetterCallbackBuilder
        {
            IIndexer_1IndexerGetterContinuationBuilder Callback(Indexer_1IndexerGetterCallback callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerGetterContinuationBuilder : IIndexer_1IndexerGetterCallbackBuilder
        {
            IIndexer_1IndexerGetterFluentBuilder Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerGetterVerifier
        {
            void Called(global::Imposter.Abstractions.Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerGetterFluentBuilder : IIndexer_1IndexerGetterOutcomeBuilder, IIndexer_1IndexerGetterContinuationBuilder
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerGetterBuilder : IIndexer_1IndexerGetterOutcomeBuilder, IIndexer_1IndexerGetterCallbackBuilder, IIndexer_1IndexerGetterVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerSetterCallbackBuilder
        {
            IIndexer_1IndexerSetterContinuationBuilder Callback(Indexer_1IndexerSetterCallback callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerSetterContinuationBuilder : IIndexer_1IndexerSetterCallbackBuilder
        {
            IIndexer_1IndexerSetterFluentBuilder Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerSetterFluentBuilder : IIndexer_1IndexerSetterCallbackBuilder, IIndexer_1IndexerSetterContinuationBuilder
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerSetterVerifier
        {
            void Called(global::Imposter.Abstractions.Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerSetterBuilder : IIndexer_1IndexerSetterCallbackBuilder, IIndexer_1IndexerSetterVerifier
        {
            IIndexer_1IndexerSetterFluentBuilder UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIndexer_1IndexerBuilder
        {
            IIndexer_1IndexerGetterBuilder Getter();
            IIndexer_1IndexerSetterBuilder Setter();
        }

        public OpenGenericClassImposter(global::Imposter.Abstractions.ImposterMode invocationBehavior = global::Imposter.Abstractions.ImposterMode.Implicit)
        {
            this._describeMethodImposter = new DescribeMethodImposter(_describeMethodInvocationHistoryCollection, invocationBehavior);
            this._echoMethodImposter = new EchoMethodImposter(_echoMethodInvocationHistoryCollection, invocationBehavior);
            this._CurrentPropertyBuilderField = new CurrentPropertyBuilder(invocationBehavior);
            this._ValueChanged = new ValueChangedEventImposterBuilder();
            this._IndexerIndexer = new IndexerIndexerBuilder(invocationBehavior, "Imposter.Tests.Features.OpenGenericImposter.OpenGenericClass<T>.this[int index]");
            this._Indexer_1Indexer = new Indexer_1IndexerBuilder(invocationBehavior, "Imposter.Tests.Features.OpenGenericImposter.OpenGenericClass<T>.this[T key, int index]");
            this._imposterInstance = new ImposterTargetInstance(this);
            this._invocationBehavior = invocationBehavior;
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class ImposterTargetInstance : global::Imposter.Tests.Features.OpenGenericImposter.OpenGenericClass<T>
        {
            private readonly OpenGenericClassImposter<T> _imposter;
            internal ImposterTargetInstance(OpenGenericClassImposter<T> _imposter) : base()
            {
                this._imposter = _imposter;
            }

            public override string Describe(T value)
            {
                return _imposter._describeMethodImposter.Invoke(value, base.Describe);
            }

            public override T Echo(T value)
            {
                return _imposter._echoMethodImposter.Invoke(value, base.Echo);
            }

            public override T Current
            {
                get
                {
                    return _imposter._CurrentPropertyBuilderField._getterImposterBuilder.Get(() => base.Current);
                }

                set
                {
                    _imposter._CurrentPropertyBuilderField._setterImposter.Set(value, (baseSetterValue) =>
                    {
                        base.Current = baseSetterValue;
                    });
                }
            }

            public override event global::System.EventHandler<global::Imposter.Tests.Features.OpenGenericImposter.GenericEventArgs<T>>? ValueChanged
            {
                add
                {
                    ArgumentNullException.ThrowIfNull(value);
                    _imposter._ValueChanged.Subscribe(value, () =>
                    {
                        base.ValueChanged += value;
                    });
                }

                remove
                {
                    ArgumentNullException.ThrowIfNull(value);
                    _imposter._ValueChanged.Unsubscribe(value, () =>
                    {
                        base.ValueChanged -= value;
                    });
                }
            }

            public override T this[int index]
            {
                get
                {
                    return _imposter._IndexerIndexer.Get(index, () => base[index]);
                }

                set
                {
                    _imposter._IndexerIndexer.Set(index, value, () =>
                    {
                        base[index] = value;
                    });
                }
            }

            public override T this[T key, int index]
            {
                get
                {
                    return _imposter._Indexer_1Indexer.Get(key, index, () => base[key, index]);
                }

                set
                {
                    _imposter._Indexer_1Indexer.Set(key, index, value, () =>
                    {
                        base[key, index] = value;
                    });
                }
            }
        }
    }
}
#nullable restore
