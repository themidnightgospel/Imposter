// <auto-generated />
#nullable enable
using global::System;
using global::System.Linq;
using global::System.Collections.Generic;
using global::System.Threading.Tasks;
using global::System.Diagnostics;
using global::System.Runtime.CompilerServices;
using global::Imposter.Abstractions;
using global::System.Collections.Concurrent;
using global::Imposter.Tests.Features.Docs.ArgumentsMatching;

namespace Imposter.Tests.Features.Docs.ArgumentsMatching
{
    [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
    public sealed class IArgumentMatchingServiceImposter : global::Imposter.Abstractions.IHaveImposterInstance<global::Imposter.Tests.Features.Docs.ArgumentsMatching.IArgumentMatchingService>
    {
        private readonly AddMethodImposter _addMethodImposter;
        private readonly IncrementMethodImposter _incrementMethodImposter;
        private readonly SumMethodImposter _sumMethodImposter;
        private readonly FormatMethodImposter _formatMethodImposter;
        private readonly InOnlyMethodImposter _inOnlyMethodImposter;
        private readonly RefOnlyMethodImposter _refOnlyMethodImposter;
        private readonly OutOnlyMethodImposter _outOnlyMethodImposter;
        private readonly AddMethodInvocationHistoryCollection _addMethodInvocationHistoryCollection = new AddMethodInvocationHistoryCollection();
        private readonly IncrementMethodInvocationHistoryCollection _incrementMethodInvocationHistoryCollection = new IncrementMethodInvocationHistoryCollection();
        private readonly SumMethodInvocationHistoryCollection _sumMethodInvocationHistoryCollection = new SumMethodInvocationHistoryCollection();
        private readonly FormatMethodInvocationHistoryCollection _formatMethodInvocationHistoryCollection = new FormatMethodInvocationHistoryCollection();
        private readonly InOnlyMethodInvocationHistoryCollection _inOnlyMethodInvocationHistoryCollection = new InOnlyMethodInvocationHistoryCollection();
        private readonly RefOnlyMethodInvocationHistoryCollection _refOnlyMethodInvocationHistoryCollection = new RefOnlyMethodInvocationHistoryCollection();
        private readonly OutOnlyMethodInvocationHistoryCollection _outOnlyMethodInvocationHistoryCollection = new OutOnlyMethodInvocationHistoryCollection();
        public IAddMethodImposterBuilder Add(global::Imposter.Abstractions.Arg<int> a, global::Imposter.Abstractions.Arg<int> b)
        {
            return new AddMethodImposter.Builder(_addMethodImposter, _addMethodInvocationHistoryCollection, new AddArgumentsCriteria(a, b));
        }

        public IIncrementMethodImposterBuilder Increment(global::Imposter.Abstractions.Arg<int> value)
        {
            return new IncrementMethodImposter.Builder(_incrementMethodImposter, _incrementMethodInvocationHistoryCollection, new IncrementArgumentsCriteria(value));
        }

        public ISumMethodImposterBuilder Sum(global::Imposter.Abstractions.Arg<int[]> values)
        {
            return new SumMethodImposter.Builder(_sumMethodImposter, _sumMethodInvocationHistoryCollection, new SumArgumentsCriteria(values));
        }

        public IFormatMethodImposterBuilder Format(global::Imposter.Abstractions.Arg<string> template, global::Imposter.Abstractions.Arg<string> value)
        {
            return new FormatMethodImposter.Builder(_formatMethodImposter, _formatMethodInvocationHistoryCollection, new FormatArgumentsCriteria(template, value));
        }

        public IInOnlyMethodImposterBuilder InOnly(global::Imposter.Abstractions.Arg<int> input)
        {
            return new InOnlyMethodImposter.Builder(_inOnlyMethodImposter, _inOnlyMethodInvocationHistoryCollection, new InOnlyArgumentsCriteria(input));
        }

        public IRefOnlyMethodImposterBuilder RefOnly(global::Imposter.Abstractions.Arg<int> state)
        {
            return new RefOnlyMethodImposter.Builder(_refOnlyMethodImposter, _refOnlyMethodInvocationHistoryCollection, new RefOnlyArgumentsCriteria(state));
        }

        public IOutOnlyMethodImposterBuilder OutOnly(global::Imposter.Abstractions.OutArg<int> result)
        {
            return new OutOnlyMethodImposter.Builder(_outOnlyMethodImposter, _outOnlyMethodInvocationHistoryCollection);
        }

        private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
        private ImposterTargetInstance _imposterInstance;
        global::Imposter.Tests.Features.Docs.ArgumentsMatching.IArgumentMatchingService global::Imposter.Abstractions.IHaveImposterInstance<global::Imposter.Tests.Features.Docs.ArgumentsMatching.IArgumentMatchingService>.Instance()
        {
            return _imposterInstance;
        }

        public delegate int AddDelegate(int a, int b);
        public delegate void AddCallbackDelegate(int a, int b);
        public delegate global::System.Exception AddExceptionGeneratorDelegate(int a, int b);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class AddArguments
        {
            public int a;
            public int b;
            internal AddArguments(int a, int b)
            {
                this.a = a;
                this.b = b;
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class AddArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<int> a { get; }
            public global::Imposter.Abstractions.Arg<int> b { get; }

            public AddArgumentsCriteria(global::Imposter.Abstractions.Arg<int> a, global::Imposter.Abstractions.Arg<int> b)
            {
                this.a = a;
                this.b = b;
            }

            public bool Matches(AddArguments arguments)
            {
                return a.Matches(arguments.a) && b.Matches(arguments.b);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IAddMethodInvocationHistory
        {
            bool Matches(AddArgumentsCriteria criteria);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class AddMethodInvocationHistory : IAddMethodInvocationHistory
        {
            internal AddArguments Arguments;
            internal int? Result;
            internal global::System.Exception? Exception;
            public AddMethodInvocationHistory(AddArguments Arguments, int? Result, global::System.Exception? Exception)
            {
                this.Arguments = Arguments;
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches(AddArgumentsCriteria criteria)
            {
                return criteria.Matches(Arguments);
            }

            public override string ToString()
            {
                return "Add(" + global::System.String.Join(", ", new[] { "a: " + FormatValue(Arguments.a), "b: " + FormatValue(Arguments.b) }) + ")" + " => " + FormatValue(Result) + (Exception == null ? "" : " threw " + FormatValue(Exception));
            }

            private static string FormatValue(object? value)
            {
                return "<" + (value?.ToString() ?? "null") + ">";
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class AddMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IAddMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IAddMethodInvocationHistory>();
            internal void Add(IAddMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count(AddArgumentsCriteria argumentsCriteria)
            {
                return _invocationHistory.Count(it => it.Matches(argumentsCriteria));
            }

            public override string ToString()
            {
                return string.Join(Environment.NewLine, _invocationHistory.Select(invocation => invocation.ToString()));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class AddMethodInvocationImposterGroup
        {
            internal static AddMethodInvocationImposterGroup Default = new AddMethodInvocationImposterGroup(new AddArgumentsCriteria(global::Imposter.Abstractions.Arg<int>.Any(), global::Imposter.Abstractions.Arg<int>.Any()));
            internal AddArgumentsCriteria ArgumentsCriteria { get; }

            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public AddMethodInvocationImposterGroup(AddArgumentsCriteria argumentsCriteria)
            {
                ArgumentsCriteria = argumentsCriteria;
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, int a, int b)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, a, b);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private AddDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<AddCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<AddCallbackDelegate>();
                internal bool IsEmpty => (_resultGenerator == null) && (_callbacks.Count == 0);

                public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, int a, int b)
                {
                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    int result = _resultGenerator.Invoke(a, b);
                    foreach (var callback in _callbacks)
                    {
                        callback(a, b);
                    }

                    return result;
                }

                internal void Callback(AddCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(AddDelegate resultGenerator)
                {
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(int value)
                {
                    _resultGenerator = (int a, int b) =>
                    {
                        return value;
                    };
                }

                internal void Throws(AddExceptionGeneratorDelegate exceptionGenerator)
                {
                    _resultGenerator = (int a, int b) =>
                    {
                        throw exceptionGenerator(a, b);
                    };
                }

                internal static int DefaultResultGenerator(int a, int b)
                {
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IAddMethodInvocationImposterGroupCallback
        {
            IAddMethodInvocationImposterGroupContinuation Callback(AddCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IAddMethodInvocationImposterGroupContinuation : IAddMethodInvocationImposterGroupCallback
        {
            IAddMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IAddMethodInvocationImposterGroup : IAddMethodInvocationImposterGroupCallback
        {
            IAddMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IAddMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IAddMethodInvocationImposterGroupContinuation Throws(AddExceptionGeneratorDelegate exceptionGenerator);
            IAddMethodInvocationImposterGroupContinuation Returns(AddDelegate resultGenerator);
            IAddMethodInvocationImposterGroupContinuation Returns(int value);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface AddInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IAddMethodImposterBuilder : IAddMethodInvocationImposterGroup, IAddMethodInvocationImposterGroupCallback, AddInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class AddMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<AddMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<AddMethodInvocationImposterGroup>();
            private readonly AddMethodInvocationHistoryCollection _addMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public AddMethodImposter(AddMethodInvocationHistoryCollection _addMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._addMethodInvocationHistoryCollection = _addMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup(AddArguments arguments)
            {
                return FindMatchingInvocationImposterGroup(arguments) != null;
            }

            private AddMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup(AddArguments arguments)
            {
                foreach (var invocationImposterGroup in _invocationImposters)
                {
                    if (invocationImposterGroup.ArgumentsCriteria.Matches(arguments))
                        return invocationImposterGroup;
                }

                return null;
            }

            public int Invoke(int a, int b)
            {
                var arguments = new AddArguments(a, b);
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup(arguments);
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("int IArgumentMatchingService.Add(int a, int b)");
                    }

                    matchingInvocationImposterGroup = AddMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "int IArgumentMatchingService.Add(int a, int b)", a, b);
                    _addMethodInvocationHistoryCollection.Add(new AddMethodInvocationHistory(arguments, result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _addMethodInvocationHistoryCollection.Add(new AddMethodInvocationHistory(arguments, default !, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IAddMethodImposterBuilder, IAddMethodInvocationImposterGroupContinuation
            {
                private readonly AddMethodImposter _imposter;
                private readonly AddMethodInvocationHistoryCollection _addMethodInvocationHistoryCollection;
                private readonly AddArgumentsCriteria _argumentsCriteria;
                private readonly AddMethodInvocationImposterGroup _invocationImposterGroup;
                private AddMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(AddMethodImposter _imposter, AddMethodInvocationHistoryCollection _addMethodInvocationHistoryCollection, AddArgumentsCriteria _argumentsCriteria)
                {
                    this._imposter = _imposter;
                    this._addMethodInvocationHistoryCollection = _addMethodInvocationHistoryCollection;
                    this._argumentsCriteria = _argumentsCriteria;
                    this._invocationImposterGroup = new AddMethodInvocationImposterGroup(_argumentsCriteria);
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((int a, int b) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((int a, int b) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroup.Throws(AddExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((int a, int b) =>
                    {
                        throw exceptionGenerator.Invoke(a, b);
                    });
                    return this;
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroupCallback.Callback(AddCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroup.Returns(AddDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IAddMethodInvocationImposterGroupContinuation IAddMethodInvocationImposterGroup.Returns(int value)
                {
                    _currentInvocationImposter.Returns(value);
                    return this;
                }

                IAddMethodInvocationImposterGroup IAddMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void AddInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _addMethodInvocationHistoryCollection.Count(_argumentsCriteria);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount, _addMethodInvocationHistoryCollection.ToString());
                    }
                }
            }
        }

        public delegate string FormatDelegate(string template, string value);
        public delegate void FormatCallbackDelegate(string template, string value);
        public delegate global::System.Exception FormatExceptionGeneratorDelegate(string template, string value);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class FormatArguments
        {
            public string template;
            public string value;
            internal FormatArguments(string template, string value)
            {
                this.template = template;
                this.value = value;
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class FormatArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<string> template { get; }
            public global::Imposter.Abstractions.Arg<string> value { get; }

            public FormatArgumentsCriteria(global::Imposter.Abstractions.Arg<string> template, global::Imposter.Abstractions.Arg<string> value)
            {
                this.template = template;
                this.value = value;
            }

            public bool Matches(FormatArguments arguments)
            {
                return template.Matches(arguments.template) && value.Matches(arguments.value);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IFormatMethodInvocationHistory
        {
            bool Matches(FormatArgumentsCriteria criteria);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class FormatMethodInvocationHistory : IFormatMethodInvocationHistory
        {
            internal FormatArguments Arguments;
            internal string? Result;
            internal global::System.Exception? Exception;
            public FormatMethodInvocationHistory(FormatArguments Arguments, string? Result, global::System.Exception? Exception)
            {
                this.Arguments = Arguments;
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches(FormatArgumentsCriteria criteria)
            {
                return criteria.Matches(Arguments);
            }

            public override string ToString()
            {
                return "Format(" + global::System.String.Join(", ", new[] { "template: " + FormatValue(Arguments.template), "value: " + FormatValue(Arguments.value) }) + ")" + " => " + FormatValue(Result) + (Exception == null ? "" : " threw " + FormatValue(Exception));
            }

            private static string FormatValue(object? value)
            {
                return "<" + (value?.ToString() ?? "null") + ">";
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class FormatMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IFormatMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IFormatMethodInvocationHistory>();
            internal void Add(IFormatMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count(FormatArgumentsCriteria argumentsCriteria)
            {
                return _invocationHistory.Count(it => it.Matches(argumentsCriteria));
            }

            public override string ToString()
            {
                return string.Join(Environment.NewLine, _invocationHistory.Select(invocation => invocation.ToString()));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class FormatMethodInvocationImposterGroup
        {
            internal static FormatMethodInvocationImposterGroup Default = new FormatMethodInvocationImposterGroup(new FormatArgumentsCriteria(global::Imposter.Abstractions.Arg<string>.Any(), global::Imposter.Abstractions.Arg<string>.Any()));
            internal FormatArgumentsCriteria ArgumentsCriteria { get; }

            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public FormatMethodInvocationImposterGroup(FormatArgumentsCriteria argumentsCriteria)
            {
                ArgumentsCriteria = argumentsCriteria;
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public string Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, string template, string value)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, template, value);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private FormatDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<FormatCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<FormatCallbackDelegate>();
                internal bool IsEmpty => (_resultGenerator == null) && (_callbacks.Count == 0);

                public string Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, string template, string value)
                {
                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    string result = _resultGenerator.Invoke(template, value);
                    foreach (var callback in _callbacks)
                    {
                        callback(template, value);
                    }

                    return result;
                }

                internal void Callback(FormatCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(FormatDelegate resultGenerator)
                {
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(string value_1)
                {
                    _resultGenerator = (string template, string value) =>
                    {
                        return value_1;
                    };
                }

                internal void Throws(FormatExceptionGeneratorDelegate exceptionGenerator)
                {
                    _resultGenerator = (string template, string value) =>
                    {
                        throw exceptionGenerator(template, value);
                    };
                }

                internal static string DefaultResultGenerator(string template, string value)
                {
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IFormatMethodInvocationImposterGroupCallback
        {
            IFormatMethodInvocationImposterGroupContinuation Callback(FormatCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IFormatMethodInvocationImposterGroupContinuation : IFormatMethodInvocationImposterGroupCallback
        {
            IFormatMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IFormatMethodInvocationImposterGroup : IFormatMethodInvocationImposterGroupCallback
        {
            IFormatMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IFormatMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IFormatMethodInvocationImposterGroupContinuation Throws(FormatExceptionGeneratorDelegate exceptionGenerator);
            IFormatMethodInvocationImposterGroupContinuation Returns(FormatDelegate resultGenerator);
            IFormatMethodInvocationImposterGroupContinuation Returns(string value);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface FormatInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IFormatMethodImposterBuilder : IFormatMethodInvocationImposterGroup, IFormatMethodInvocationImposterGroupCallback, FormatInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class FormatMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<FormatMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<FormatMethodInvocationImposterGroup>();
            private readonly FormatMethodInvocationHistoryCollection _formatMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public FormatMethodImposter(FormatMethodInvocationHistoryCollection _formatMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._formatMethodInvocationHistoryCollection = _formatMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup(FormatArguments arguments)
            {
                return FindMatchingInvocationImposterGroup(arguments) != null;
            }

            private FormatMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup(FormatArguments arguments)
            {
                foreach (var invocationImposterGroup in _invocationImposters)
                {
                    if (invocationImposterGroup.ArgumentsCriteria.Matches(arguments))
                        return invocationImposterGroup;
                }

                return null;
            }

            public string Invoke(string template, string value)
            {
                var arguments = new FormatArguments(template, value);
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup(arguments);
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("string IArgumentMatchingService.Format(string template, string value)");
                    }

                    matchingInvocationImposterGroup = FormatMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "string IArgumentMatchingService.Format(string template, string value)", template, value);
                    _formatMethodInvocationHistoryCollection.Add(new FormatMethodInvocationHistory(arguments, result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _formatMethodInvocationHistoryCollection.Add(new FormatMethodInvocationHistory(arguments, default !, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IFormatMethodImposterBuilder, IFormatMethodInvocationImposterGroupContinuation
            {
                private readonly FormatMethodImposter _imposter;
                private readonly FormatMethodInvocationHistoryCollection _formatMethodInvocationHistoryCollection;
                private readonly FormatArgumentsCriteria _argumentsCriteria;
                private readonly FormatMethodInvocationImposterGroup _invocationImposterGroup;
                private FormatMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(FormatMethodImposter _imposter, FormatMethodInvocationHistoryCollection _formatMethodInvocationHistoryCollection, FormatArgumentsCriteria _argumentsCriteria)
                {
                    this._imposter = _imposter;
                    this._formatMethodInvocationHistoryCollection = _formatMethodInvocationHistoryCollection;
                    this._argumentsCriteria = _argumentsCriteria;
                    this._invocationImposterGroup = new FormatMethodInvocationImposterGroup(_argumentsCriteria);
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IFormatMethodInvocationImposterGroupContinuation IFormatMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((string template, string value) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IFormatMethodInvocationImposterGroupContinuation IFormatMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((string template, string value) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IFormatMethodInvocationImposterGroupContinuation IFormatMethodInvocationImposterGroup.Throws(FormatExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((string template, string value) =>
                    {
                        throw exceptionGenerator.Invoke(template, value);
                    });
                    return this;
                }

                IFormatMethodInvocationImposterGroupContinuation IFormatMethodInvocationImposterGroupCallback.Callback(FormatCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IFormatMethodInvocationImposterGroupContinuation IFormatMethodInvocationImposterGroup.Returns(FormatDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IFormatMethodInvocationImposterGroupContinuation IFormatMethodInvocationImposterGroup.Returns(string value_1)
                {
                    _currentInvocationImposter.Returns(value_1);
                    return this;
                }

                IFormatMethodInvocationImposterGroup IFormatMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void FormatInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _formatMethodInvocationHistoryCollection.Count(_argumentsCriteria);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount, _formatMethodInvocationHistoryCollection.ToString());
                    }
                }
            }
        }

        public delegate int InOnlyDelegate(in int input);
        public delegate void InOnlyCallbackDelegate(in int input);
        public delegate global::System.Exception InOnlyExceptionGeneratorDelegate(in int input);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class InOnlyArguments
        {
            public int input;
            internal InOnlyArguments(int input)
            {
                this.input = input;
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class InOnlyArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<int> input { get; }

            public InOnlyArgumentsCriteria(global::Imposter.Abstractions.Arg<int> input)
            {
                this.input = input;
            }

            public bool Matches(InOnlyArguments arguments)
            {
                return input.Matches(arguments.input);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IInOnlyMethodInvocationHistory
        {
            bool Matches(InOnlyArgumentsCriteria criteria);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class InOnlyMethodInvocationHistory : IInOnlyMethodInvocationHistory
        {
            internal InOnlyArguments Arguments;
            internal int? Result;
            internal global::System.Exception? Exception;
            public InOnlyMethodInvocationHistory(InOnlyArguments Arguments, int? Result, global::System.Exception? Exception)
            {
                this.Arguments = Arguments;
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches(InOnlyArgumentsCriteria criteria)
            {
                return criteria.Matches(Arguments);
            }

            public override string ToString()
            {
                return "InOnly(" + global::System.String.Join(", ", new[] { "input: " + FormatValue(Arguments.input) }) + ")" + " => " + FormatValue(Result) + (Exception == null ? "" : " threw " + FormatValue(Exception));
            }

            private static string FormatValue(object? value)
            {
                return "<" + (value?.ToString() ?? "null") + ">";
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class InOnlyMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IInOnlyMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IInOnlyMethodInvocationHistory>();
            internal void Add(IInOnlyMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count(InOnlyArgumentsCriteria argumentsCriteria)
            {
                return _invocationHistory.Count(it => it.Matches(argumentsCriteria));
            }

            public override string ToString()
            {
                return string.Join(Environment.NewLine, _invocationHistory.Select(invocation => invocation.ToString()));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class InOnlyMethodInvocationImposterGroup
        {
            internal static InOnlyMethodInvocationImposterGroup Default = new InOnlyMethodInvocationImposterGroup(new InOnlyArgumentsCriteria(global::Imposter.Abstractions.Arg<int>.Any()));
            internal InOnlyArgumentsCriteria ArgumentsCriteria { get; }

            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public InOnlyMethodInvocationImposterGroup(InOnlyArgumentsCriteria argumentsCriteria)
            {
                ArgumentsCriteria = argumentsCriteria;
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, in int input)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, in input);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private InOnlyDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<InOnlyCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<InOnlyCallbackDelegate>();
                internal bool IsEmpty => (_resultGenerator == null) && (_callbacks.Count == 0);

                public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, in int input)
                {
                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    int result = _resultGenerator.Invoke(in input);
                    foreach (var callback in _callbacks)
                    {
                        callback(in input);
                    }

                    return result;
                }

                internal void Callback(InOnlyCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(InOnlyDelegate resultGenerator)
                {
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(int value)
                {
                    _resultGenerator = (in int input) =>
                    {
                        return value;
                    };
                }

                internal void Throws(InOnlyExceptionGeneratorDelegate exceptionGenerator)
                {
                    _resultGenerator = (in int input) =>
                    {
                        throw exceptionGenerator(in input);
                    };
                }

                internal static int DefaultResultGenerator(in int input)
                {
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IInOnlyMethodInvocationImposterGroupCallback
        {
            IInOnlyMethodInvocationImposterGroupContinuation Callback(InOnlyCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IInOnlyMethodInvocationImposterGroupContinuation : IInOnlyMethodInvocationImposterGroupCallback
        {
            IInOnlyMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IInOnlyMethodInvocationImposterGroup : IInOnlyMethodInvocationImposterGroupCallback
        {
            IInOnlyMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IInOnlyMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IInOnlyMethodInvocationImposterGroupContinuation Throws(InOnlyExceptionGeneratorDelegate exceptionGenerator);
            IInOnlyMethodInvocationImposterGroupContinuation Returns(InOnlyDelegate resultGenerator);
            IInOnlyMethodInvocationImposterGroupContinuation Returns(int value);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface InOnlyInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IInOnlyMethodImposterBuilder : IInOnlyMethodInvocationImposterGroup, IInOnlyMethodInvocationImposterGroupCallback, InOnlyInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class InOnlyMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<InOnlyMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<InOnlyMethodInvocationImposterGroup>();
            private readonly InOnlyMethodInvocationHistoryCollection _inOnlyMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public InOnlyMethodImposter(InOnlyMethodInvocationHistoryCollection _inOnlyMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._inOnlyMethodInvocationHistoryCollection = _inOnlyMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup(InOnlyArguments arguments)
            {
                return FindMatchingInvocationImposterGroup(arguments) != null;
            }

            private InOnlyMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup(InOnlyArguments arguments)
            {
                foreach (var invocationImposterGroup in _invocationImposters)
                {
                    if (invocationImposterGroup.ArgumentsCriteria.Matches(arguments))
                        return invocationImposterGroup;
                }

                return null;
            }

            public int Invoke(in int input)
            {
                var arguments = new InOnlyArguments(input);
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup(arguments);
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("int IArgumentMatchingService.InOnly(in int input)");
                    }

                    matchingInvocationImposterGroup = InOnlyMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "int IArgumentMatchingService.InOnly(in int input)", in input);
                    _inOnlyMethodInvocationHistoryCollection.Add(new InOnlyMethodInvocationHistory(arguments, result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _inOnlyMethodInvocationHistoryCollection.Add(new InOnlyMethodInvocationHistory(arguments, default !, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IInOnlyMethodImposterBuilder, IInOnlyMethodInvocationImposterGroupContinuation
            {
                private readonly InOnlyMethodImposter _imposter;
                private readonly InOnlyMethodInvocationHistoryCollection _inOnlyMethodInvocationHistoryCollection;
                private readonly InOnlyArgumentsCriteria _argumentsCriteria;
                private readonly InOnlyMethodInvocationImposterGroup _invocationImposterGroup;
                private InOnlyMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(InOnlyMethodImposter _imposter, InOnlyMethodInvocationHistoryCollection _inOnlyMethodInvocationHistoryCollection, InOnlyArgumentsCriteria _argumentsCriteria)
                {
                    this._imposter = _imposter;
                    this._inOnlyMethodInvocationHistoryCollection = _inOnlyMethodInvocationHistoryCollection;
                    this._argumentsCriteria = _argumentsCriteria;
                    this._invocationImposterGroup = new InOnlyMethodInvocationImposterGroup(_argumentsCriteria);
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IInOnlyMethodInvocationImposterGroupContinuation IInOnlyMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((in int input) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IInOnlyMethodInvocationImposterGroupContinuation IInOnlyMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((in int input) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IInOnlyMethodInvocationImposterGroupContinuation IInOnlyMethodInvocationImposterGroup.Throws(InOnlyExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((in int input) =>
                    {
                        throw exceptionGenerator.Invoke(in input);
                    });
                    return this;
                }

                IInOnlyMethodInvocationImposterGroupContinuation IInOnlyMethodInvocationImposterGroupCallback.Callback(InOnlyCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IInOnlyMethodInvocationImposterGroupContinuation IInOnlyMethodInvocationImposterGroup.Returns(InOnlyDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IInOnlyMethodInvocationImposterGroupContinuation IInOnlyMethodInvocationImposterGroup.Returns(int value)
                {
                    _currentInvocationImposter.Returns(value);
                    return this;
                }

                IInOnlyMethodInvocationImposterGroup IInOnlyMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void InOnlyInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _inOnlyMethodInvocationHistoryCollection.Count(_argumentsCriteria);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount, _inOnlyMethodInvocationHistoryCollection.ToString());
                    }
                }
            }
        }

        public delegate int IncrementDelegate(int value);
        public delegate void IncrementCallbackDelegate(int value);
        public delegate global::System.Exception IncrementExceptionGeneratorDelegate(int value);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class IncrementArguments
        {
            public int value;
            internal IncrementArguments(int value)
            {
                this.value = value;
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class IncrementArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<int> value { get; }

            public IncrementArgumentsCriteria(global::Imposter.Abstractions.Arg<int> value)
            {
                this.value = value;
            }

            public bool Matches(IncrementArguments arguments)
            {
                return value.Matches(arguments.value);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIncrementMethodInvocationHistory
        {
            bool Matches(IncrementArgumentsCriteria criteria);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class IncrementMethodInvocationHistory : IIncrementMethodInvocationHistory
        {
            internal IncrementArguments Arguments;
            internal int? Result;
            internal global::System.Exception? Exception;
            public IncrementMethodInvocationHistory(IncrementArguments Arguments, int? Result, global::System.Exception? Exception)
            {
                this.Arguments = Arguments;
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches(IncrementArgumentsCriteria criteria)
            {
                return criteria.Matches(Arguments);
            }

            public override string ToString()
            {
                return "Increment(" + global::System.String.Join(", ", new[] { "value: " + FormatValue(Arguments.value) }) + ")" + " => " + FormatValue(Result) + (Exception == null ? "" : " threw " + FormatValue(Exception));
            }

            private static string FormatValue(object? value)
            {
                return "<" + (value?.ToString() ?? "null") + ">";
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class IncrementMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IIncrementMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IIncrementMethodInvocationHistory>();
            internal void Add(IIncrementMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count(IncrementArgumentsCriteria argumentsCriteria)
            {
                return _invocationHistory.Count(it => it.Matches(argumentsCriteria));
            }

            public override string ToString()
            {
                return string.Join(Environment.NewLine, _invocationHistory.Select(invocation => invocation.ToString()));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class IncrementMethodInvocationImposterGroup
        {
            internal static IncrementMethodInvocationImposterGroup Default = new IncrementMethodInvocationImposterGroup(new IncrementArgumentsCriteria(global::Imposter.Abstractions.Arg<int>.Any()));
            internal IncrementArgumentsCriteria ArgumentsCriteria { get; }

            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public IncrementMethodInvocationImposterGroup(IncrementArgumentsCriteria argumentsCriteria)
            {
                ArgumentsCriteria = argumentsCriteria;
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, int value)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, value);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private IncrementDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<IncrementCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<IncrementCallbackDelegate>();
                internal bool IsEmpty => (_resultGenerator == null) && (_callbacks.Count == 0);

                public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, int value)
                {
                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    int result = _resultGenerator.Invoke(value);
                    foreach (var callback in _callbacks)
                    {
                        callback(value);
                    }

                    return result;
                }

                internal void Callback(IncrementCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(IncrementDelegate resultGenerator)
                {
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(int value_1)
                {
                    _resultGenerator = (int value) =>
                    {
                        return value_1;
                    };
                }

                internal void Throws(IncrementExceptionGeneratorDelegate exceptionGenerator)
                {
                    _resultGenerator = (int value) =>
                    {
                        throw exceptionGenerator(value);
                    };
                }

                internal static int DefaultResultGenerator(int value)
                {
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIncrementMethodInvocationImposterGroupCallback
        {
            IIncrementMethodInvocationImposterGroupContinuation Callback(IncrementCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIncrementMethodInvocationImposterGroupContinuation : IIncrementMethodInvocationImposterGroupCallback
        {
            IIncrementMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIncrementMethodInvocationImposterGroup : IIncrementMethodInvocationImposterGroupCallback
        {
            IIncrementMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IIncrementMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IIncrementMethodInvocationImposterGroupContinuation Throws(IncrementExceptionGeneratorDelegate exceptionGenerator);
            IIncrementMethodInvocationImposterGroupContinuation Returns(IncrementDelegate resultGenerator);
            IIncrementMethodInvocationImposterGroupContinuation Returns(int value);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IncrementInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IIncrementMethodImposterBuilder : IIncrementMethodInvocationImposterGroup, IIncrementMethodInvocationImposterGroupCallback, IncrementInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class IncrementMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IncrementMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<IncrementMethodInvocationImposterGroup>();
            private readonly IncrementMethodInvocationHistoryCollection _incrementMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public IncrementMethodImposter(IncrementMethodInvocationHistoryCollection _incrementMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._incrementMethodInvocationHistoryCollection = _incrementMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup(IncrementArguments arguments)
            {
                return FindMatchingInvocationImposterGroup(arguments) != null;
            }

            private IncrementMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup(IncrementArguments arguments)
            {
                foreach (var invocationImposterGroup in _invocationImposters)
                {
                    if (invocationImposterGroup.ArgumentsCriteria.Matches(arguments))
                        return invocationImposterGroup;
                }

                return null;
            }

            public int Invoke(int value)
            {
                var arguments = new IncrementArguments(value);
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup(arguments);
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("int IArgumentMatchingService.Increment(int value)");
                    }

                    matchingInvocationImposterGroup = IncrementMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "int IArgumentMatchingService.Increment(int value)", value);
                    _incrementMethodInvocationHistoryCollection.Add(new IncrementMethodInvocationHistory(arguments, result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _incrementMethodInvocationHistoryCollection.Add(new IncrementMethodInvocationHistory(arguments, default !, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IIncrementMethodImposterBuilder, IIncrementMethodInvocationImposterGroupContinuation
            {
                private readonly IncrementMethodImposter _imposter;
                private readonly IncrementMethodInvocationHistoryCollection _incrementMethodInvocationHistoryCollection;
                private readonly IncrementArgumentsCriteria _argumentsCriteria;
                private readonly IncrementMethodInvocationImposterGroup _invocationImposterGroup;
                private IncrementMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(IncrementMethodImposter _imposter, IncrementMethodInvocationHistoryCollection _incrementMethodInvocationHistoryCollection, IncrementArgumentsCriteria _argumentsCriteria)
                {
                    this._imposter = _imposter;
                    this._incrementMethodInvocationHistoryCollection = _incrementMethodInvocationHistoryCollection;
                    this._argumentsCriteria = _argumentsCriteria;
                    this._invocationImposterGroup = new IncrementMethodInvocationImposterGroup(_argumentsCriteria);
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IIncrementMethodInvocationImposterGroupContinuation IIncrementMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((int value) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IIncrementMethodInvocationImposterGroupContinuation IIncrementMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((int value) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IIncrementMethodInvocationImposterGroupContinuation IIncrementMethodInvocationImposterGroup.Throws(IncrementExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((int value) =>
                    {
                        throw exceptionGenerator.Invoke(value);
                    });
                    return this;
                }

                IIncrementMethodInvocationImposterGroupContinuation IIncrementMethodInvocationImposterGroupCallback.Callback(IncrementCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IIncrementMethodInvocationImposterGroupContinuation IIncrementMethodInvocationImposterGroup.Returns(IncrementDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IIncrementMethodInvocationImposterGroupContinuation IIncrementMethodInvocationImposterGroup.Returns(int value_1)
                {
                    _currentInvocationImposter.Returns(value_1);
                    return this;
                }

                IIncrementMethodInvocationImposterGroup IIncrementMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void IncrementInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _incrementMethodInvocationHistoryCollection.Count(_argumentsCriteria);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount, _incrementMethodInvocationHistoryCollection.ToString());
                    }
                }
            }
        }

        public delegate int OutOnlyDelegate(out int result);
        public delegate void OutOnlyCallbackDelegate(out int result);
        public delegate global::System.Exception OutOnlyExceptionGeneratorDelegate(out int result);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IOutOnlyMethodInvocationHistory
        {
            bool Matches();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class OutOnlyMethodInvocationHistory : IOutOnlyMethodInvocationHistory
        {
            internal int? Result;
            internal global::System.Exception? Exception;
            public OutOnlyMethodInvocationHistory(int? Result, global::System.Exception? Exception)
            {
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches()
            {
                return true;
            }

            public override string ToString()
            {
                return "OutOnly(" + "" + ")" + " => " + FormatValue(Result) + (Exception == null ? "" : " threw " + FormatValue(Exception));
            }

            private static string FormatValue(object? value)
            {
                return "<" + (value?.ToString() ?? "null") + ">";
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class OutOnlyMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IOutOnlyMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IOutOnlyMethodInvocationHistory>();
            internal void Add(IOutOnlyMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count()
            {
                return _invocationHistory.Count(it => it.Matches());
            }

            public override string ToString()
            {
                return string.Join(Environment.NewLine, _invocationHistory.Select(invocation => invocation.ToString()));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class OutOnlyMethodInvocationImposterGroup
        {
            internal static OutOnlyMethodInvocationImposterGroup Default = new OutOnlyMethodInvocationImposterGroup();
            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public OutOnlyMethodInvocationImposterGroup()
            {
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, out int result)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, out result);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private OutOnlyDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<OutOnlyCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<OutOnlyCallbackDelegate>();
                internal bool IsEmpty => (_resultGenerator == null) && (_callbacks.Count == 0);

                public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, out int result)
                {
                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    int result_1 = _resultGenerator.Invoke(out result);
                    foreach (var callback in _callbacks)
                    {
                        callback(out result);
                    }

                    return result_1;
                }

                internal void Callback(OutOnlyCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(OutOnlyDelegate resultGenerator)
                {
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(int value)
                {
                    _resultGenerator = (out int result) =>
                    {
                        InitializeOutParametersWithDefaultValues(out result);
                        return value;
                    };
                }

                internal void Throws(OutOnlyExceptionGeneratorDelegate exceptionGenerator)
                {
                    _resultGenerator = (out int result) =>
                    {
                        throw exceptionGenerator(out result);
                    };
                }

                private static void InitializeOutParametersWithDefaultValues(out int result)
                {
                    result = default !;
                }

                internal static int DefaultResultGenerator(out int result)
                {
                    InitializeOutParametersWithDefaultValues(out result);
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IOutOnlyMethodInvocationImposterGroupCallback
        {
            IOutOnlyMethodInvocationImposterGroupContinuation Callback(OutOnlyCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IOutOnlyMethodInvocationImposterGroupContinuation : IOutOnlyMethodInvocationImposterGroupCallback
        {
            IOutOnlyMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IOutOnlyMethodInvocationImposterGroup : IOutOnlyMethodInvocationImposterGroupCallback
        {
            IOutOnlyMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IOutOnlyMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IOutOnlyMethodInvocationImposterGroupContinuation Throws(OutOnlyExceptionGeneratorDelegate exceptionGenerator);
            IOutOnlyMethodInvocationImposterGroupContinuation Returns(OutOnlyDelegate resultGenerator);
            IOutOnlyMethodInvocationImposterGroupContinuation Returns(int value);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface OutOnlyInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IOutOnlyMethodImposterBuilder : IOutOnlyMethodInvocationImposterGroup, IOutOnlyMethodInvocationImposterGroupCallback, OutOnlyInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class OutOnlyMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<OutOnlyMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<OutOnlyMethodInvocationImposterGroup>();
            private readonly OutOnlyMethodInvocationHistoryCollection _outOnlyMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public OutOnlyMethodImposter(OutOnlyMethodInvocationHistoryCollection _outOnlyMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._outOnlyMethodInvocationHistoryCollection = _outOnlyMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            private static void InitializeOutParametersWithDefaultValues(out int result)
            {
                result = default !;
            }

            public bool HasMatchingInvocationImposterGroup()
            {
                return FindMatchingInvocationImposterGroup() != null;
            }

            private OutOnlyMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup()
            {
                if (_invocationImposters.TryPeek(out var invocationImposterGroup))
                    return invocationImposterGroup;
                else
                    return null;
            }

            public int Invoke(out int result)
            {
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup();
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("int IArgumentMatchingService.OutOnly(out int result)");
                    }

                    matchingInvocationImposterGroup = OutOnlyMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result_1 = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "int IArgumentMatchingService.OutOnly(out int result)", out result);
                    _outOnlyMethodInvocationHistoryCollection.Add(new OutOnlyMethodInvocationHistory(result_1, default));
                    return result_1;
                }
                catch (global::System.Exception ex)
                {
                    _outOnlyMethodInvocationHistoryCollection.Add(new OutOnlyMethodInvocationHistory(default !, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IOutOnlyMethodImposterBuilder, IOutOnlyMethodInvocationImposterGroupContinuation
            {
                private readonly OutOnlyMethodImposter _imposter;
                private readonly OutOnlyMethodInvocationHistoryCollection _outOnlyMethodInvocationHistoryCollection;
                private readonly OutOnlyMethodInvocationImposterGroup _invocationImposterGroup;
                private OutOnlyMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(OutOnlyMethodImposter _imposter, OutOnlyMethodInvocationHistoryCollection _outOnlyMethodInvocationHistoryCollection)
                {
                    this._imposter = _imposter;
                    this._outOnlyMethodInvocationHistoryCollection = _outOnlyMethodInvocationHistoryCollection;
                    this._invocationImposterGroup = new OutOnlyMethodInvocationImposterGroup();
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IOutOnlyMethodInvocationImposterGroupContinuation IOutOnlyMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((out int result) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IOutOnlyMethodInvocationImposterGroupContinuation IOutOnlyMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((out int result) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IOutOnlyMethodInvocationImposterGroupContinuation IOutOnlyMethodInvocationImposterGroup.Throws(OutOnlyExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((out int result) =>
                    {
                        throw exceptionGenerator.Invoke(out result);
                    });
                    return this;
                }

                IOutOnlyMethodInvocationImposterGroupContinuation IOutOnlyMethodInvocationImposterGroupCallback.Callback(OutOnlyCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IOutOnlyMethodInvocationImposterGroupContinuation IOutOnlyMethodInvocationImposterGroup.Returns(OutOnlyDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IOutOnlyMethodInvocationImposterGroupContinuation IOutOnlyMethodInvocationImposterGroup.Returns(int value)
                {
                    _currentInvocationImposter.Returns(value);
                    return this;
                }

                IOutOnlyMethodInvocationImposterGroup IOutOnlyMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void OutOnlyInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _outOnlyMethodInvocationHistoryCollection.Count();
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount, _outOnlyMethodInvocationHistoryCollection.ToString());
                    }
                }
            }
        }

        public delegate int RefOnlyDelegate(ref int state);
        public delegate void RefOnlyCallbackDelegate(ref int state);
        public delegate global::System.Exception RefOnlyExceptionGeneratorDelegate(ref int state);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class RefOnlyArguments
        {
            public int state;
            internal RefOnlyArguments(int state)
            {
                this.state = state;
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class RefOnlyArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<int> state { get; }

            public RefOnlyArgumentsCriteria(global::Imposter.Abstractions.Arg<int> state)
            {
                this.state = state;
            }

            public bool Matches(RefOnlyArguments arguments)
            {
                return state.Matches(arguments.state);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IRefOnlyMethodInvocationHistory
        {
            bool Matches(RefOnlyArgumentsCriteria criteria);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class RefOnlyMethodInvocationHistory : IRefOnlyMethodInvocationHistory
        {
            internal RefOnlyArguments Arguments;
            internal int? Result;
            internal global::System.Exception? Exception;
            public RefOnlyMethodInvocationHistory(RefOnlyArguments Arguments, int? Result, global::System.Exception? Exception)
            {
                this.Arguments = Arguments;
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches(RefOnlyArgumentsCriteria criteria)
            {
                return criteria.Matches(Arguments);
            }

            public override string ToString()
            {
                return "RefOnly(" + global::System.String.Join(", ", new[] { "state: " + FormatValue(Arguments.state) }) + ")" + " => " + FormatValue(Result) + (Exception == null ? "" : " threw " + FormatValue(Exception));
            }

            private static string FormatValue(object? value)
            {
                return "<" + (value?.ToString() ?? "null") + ">";
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class RefOnlyMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IRefOnlyMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IRefOnlyMethodInvocationHistory>();
            internal void Add(IRefOnlyMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count(RefOnlyArgumentsCriteria argumentsCriteria)
            {
                return _invocationHistory.Count(it => it.Matches(argumentsCriteria));
            }

            public override string ToString()
            {
                return string.Join(Environment.NewLine, _invocationHistory.Select(invocation => invocation.ToString()));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class RefOnlyMethodInvocationImposterGroup
        {
            internal static RefOnlyMethodInvocationImposterGroup Default = new RefOnlyMethodInvocationImposterGroup(new RefOnlyArgumentsCriteria(global::Imposter.Abstractions.Arg<int>.Any()));
            internal RefOnlyArgumentsCriteria ArgumentsCriteria { get; }

            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public RefOnlyMethodInvocationImposterGroup(RefOnlyArgumentsCriteria argumentsCriteria)
            {
                ArgumentsCriteria = argumentsCriteria;
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, ref int state)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, ref state);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private RefOnlyDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<RefOnlyCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<RefOnlyCallbackDelegate>();
                internal bool IsEmpty => (_resultGenerator == null) && (_callbacks.Count == 0);

                public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, ref int state)
                {
                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    int result = _resultGenerator.Invoke(ref state);
                    foreach (var callback in _callbacks)
                    {
                        callback(ref state);
                    }

                    return result;
                }

                internal void Callback(RefOnlyCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(RefOnlyDelegate resultGenerator)
                {
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(int value)
                {
                    _resultGenerator = (ref int state) =>
                    {
                        return value;
                    };
                }

                internal void Throws(RefOnlyExceptionGeneratorDelegate exceptionGenerator)
                {
                    _resultGenerator = (ref int state) =>
                    {
                        throw exceptionGenerator(ref state);
                    };
                }

                internal static int DefaultResultGenerator(ref int state)
                {
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IRefOnlyMethodInvocationImposterGroupCallback
        {
            IRefOnlyMethodInvocationImposterGroupContinuation Callback(RefOnlyCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IRefOnlyMethodInvocationImposterGroupContinuation : IRefOnlyMethodInvocationImposterGroupCallback
        {
            IRefOnlyMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IRefOnlyMethodInvocationImposterGroup : IRefOnlyMethodInvocationImposterGroupCallback
        {
            IRefOnlyMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IRefOnlyMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IRefOnlyMethodInvocationImposterGroupContinuation Throws(RefOnlyExceptionGeneratorDelegate exceptionGenerator);
            IRefOnlyMethodInvocationImposterGroupContinuation Returns(RefOnlyDelegate resultGenerator);
            IRefOnlyMethodInvocationImposterGroupContinuation Returns(int value);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface RefOnlyInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IRefOnlyMethodImposterBuilder : IRefOnlyMethodInvocationImposterGroup, IRefOnlyMethodInvocationImposterGroupCallback, RefOnlyInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class RefOnlyMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<RefOnlyMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<RefOnlyMethodInvocationImposterGroup>();
            private readonly RefOnlyMethodInvocationHistoryCollection _refOnlyMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public RefOnlyMethodImposter(RefOnlyMethodInvocationHistoryCollection _refOnlyMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._refOnlyMethodInvocationHistoryCollection = _refOnlyMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup(RefOnlyArguments arguments)
            {
                return FindMatchingInvocationImposterGroup(arguments) != null;
            }

            private RefOnlyMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup(RefOnlyArguments arguments)
            {
                foreach (var invocationImposterGroup in _invocationImposters)
                {
                    if (invocationImposterGroup.ArgumentsCriteria.Matches(arguments))
                        return invocationImposterGroup;
                }

                return null;
            }

            public int Invoke(ref int state)
            {
                var arguments = new RefOnlyArguments(state);
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup(arguments);
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("int IArgumentMatchingService.RefOnly(ref int state)");
                    }

                    matchingInvocationImposterGroup = RefOnlyMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "int IArgumentMatchingService.RefOnly(ref int state)", ref state);
                    _refOnlyMethodInvocationHistoryCollection.Add(new RefOnlyMethodInvocationHistory(arguments, result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _refOnlyMethodInvocationHistoryCollection.Add(new RefOnlyMethodInvocationHistory(arguments, default !, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IRefOnlyMethodImposterBuilder, IRefOnlyMethodInvocationImposterGroupContinuation
            {
                private readonly RefOnlyMethodImposter _imposter;
                private readonly RefOnlyMethodInvocationHistoryCollection _refOnlyMethodInvocationHistoryCollection;
                private readonly RefOnlyArgumentsCriteria _argumentsCriteria;
                private readonly RefOnlyMethodInvocationImposterGroup _invocationImposterGroup;
                private RefOnlyMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(RefOnlyMethodImposter _imposter, RefOnlyMethodInvocationHistoryCollection _refOnlyMethodInvocationHistoryCollection, RefOnlyArgumentsCriteria _argumentsCriteria)
                {
                    this._imposter = _imposter;
                    this._refOnlyMethodInvocationHistoryCollection = _refOnlyMethodInvocationHistoryCollection;
                    this._argumentsCriteria = _argumentsCriteria;
                    this._invocationImposterGroup = new RefOnlyMethodInvocationImposterGroup(_argumentsCriteria);
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IRefOnlyMethodInvocationImposterGroupContinuation IRefOnlyMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((ref int state) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IRefOnlyMethodInvocationImposterGroupContinuation IRefOnlyMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((ref int state) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IRefOnlyMethodInvocationImposterGroupContinuation IRefOnlyMethodInvocationImposterGroup.Throws(RefOnlyExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((ref int state) =>
                    {
                        throw exceptionGenerator.Invoke(ref state);
                    });
                    return this;
                }

                IRefOnlyMethodInvocationImposterGroupContinuation IRefOnlyMethodInvocationImposterGroupCallback.Callback(RefOnlyCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IRefOnlyMethodInvocationImposterGroupContinuation IRefOnlyMethodInvocationImposterGroup.Returns(RefOnlyDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IRefOnlyMethodInvocationImposterGroupContinuation IRefOnlyMethodInvocationImposterGroup.Returns(int value)
                {
                    _currentInvocationImposter.Returns(value);
                    return this;
                }

                IRefOnlyMethodInvocationImposterGroup IRefOnlyMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void RefOnlyInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _refOnlyMethodInvocationHistoryCollection.Count(_argumentsCriteria);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount, _refOnlyMethodInvocationHistoryCollection.ToString());
                    }
                }
            }
        }

        public delegate int SumDelegate(int[] values);
        public delegate void SumCallbackDelegate(int[] values);
        public delegate global::System.Exception SumExceptionGeneratorDelegate(int[] values);
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class SumArguments
        {
            public int[] values;
            internal SumArguments(int[] values)
            {
                this.values = values;
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public class SumArgumentsCriteria
        {
            public global::Imposter.Abstractions.Arg<int[]> values { get; }

            public SumArgumentsCriteria(global::Imposter.Abstractions.Arg<int[]> values)
            {
                this.values = values;
            }

            public bool Matches(SumArguments arguments)
            {
                return values.Matches(arguments.values);
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ISumMethodInvocationHistory
        {
            bool Matches(SumArgumentsCriteria criteria);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class SumMethodInvocationHistory : ISumMethodInvocationHistory
        {
            internal SumArguments Arguments;
            internal int? Result;
            internal global::System.Exception? Exception;
            public SumMethodInvocationHistory(SumArguments Arguments, int? Result, global::System.Exception? Exception)
            {
                this.Arguments = Arguments;
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches(SumArgumentsCriteria criteria)
            {
                return criteria.Matches(Arguments);
            }

            public override string ToString()
            {
                return "Sum(" + global::System.String.Join(", ", new[] { "values: " + FormatValue(Arguments.values) }) + ")" + " => " + FormatValue(Result) + (Exception == null ? "" : " threw " + FormatValue(Exception));
            }

            private static string FormatValue(object? value)
            {
                return "<" + (value?.ToString() ?? "null") + ">";
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class SumMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<ISumMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<ISumMethodInvocationHistory>();
            internal void Add(ISumMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count(SumArgumentsCriteria argumentsCriteria)
            {
                return _invocationHistory.Count(it => it.Matches(argumentsCriteria));
            }

            public override string ToString()
            {
                return string.Join(Environment.NewLine, _invocationHistory.Select(invocation => invocation.ToString()));
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class SumMethodInvocationImposterGroup
        {
            internal static SumMethodInvocationImposterGroup Default = new SumMethodInvocationImposterGroup(new SumArgumentsCriteria(global::Imposter.Abstractions.Arg<int[]>.Any()));
            internal SumArgumentsCriteria ArgumentsCriteria { get; }

            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public SumMethodInvocationImposterGroup(SumArgumentsCriteria argumentsCriteria)
            {
                ArgumentsCriteria = argumentsCriteria;
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, int[] values)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, values);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private SumDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<SumCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<SumCallbackDelegate>();
                internal bool IsEmpty => (_resultGenerator == null) && (_callbacks.Count == 0);

                public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, int[] values)
                {
                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    int result = _resultGenerator.Invoke(values);
                    foreach (var callback in _callbacks)
                    {
                        callback(values);
                    }

                    return result;
                }

                internal void Callback(SumCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(SumDelegate resultGenerator)
                {
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(int value)
                {
                    _resultGenerator = (int[] values) =>
                    {
                        return value;
                    };
                }

                internal void Throws(SumExceptionGeneratorDelegate exceptionGenerator)
                {
                    _resultGenerator = (int[] values) =>
                    {
                        throw exceptionGenerator(values);
                    };
                }

                internal static int DefaultResultGenerator(int[] values)
                {
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ISumMethodInvocationImposterGroupCallback
        {
            ISumMethodInvocationImposterGroupContinuation Callback(SumCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ISumMethodInvocationImposterGroupContinuation : ISumMethodInvocationImposterGroupCallback
        {
            ISumMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ISumMethodInvocationImposterGroup : ISumMethodInvocationImposterGroupCallback
        {
            ISumMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            ISumMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            ISumMethodInvocationImposterGroupContinuation Throws(SumExceptionGeneratorDelegate exceptionGenerator);
            ISumMethodInvocationImposterGroupContinuation Returns(SumDelegate resultGenerator);
            ISumMethodInvocationImposterGroupContinuation Returns(int value);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface SumInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface ISumMethodImposterBuilder : ISumMethodInvocationImposterGroup, ISumMethodInvocationImposterGroupCallback, SumInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class SumMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<SumMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<SumMethodInvocationImposterGroup>();
            private readonly SumMethodInvocationHistoryCollection _sumMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public SumMethodImposter(SumMethodInvocationHistoryCollection _sumMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._sumMethodInvocationHistoryCollection = _sumMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup(SumArguments arguments)
            {
                return FindMatchingInvocationImposterGroup(arguments) != null;
            }

            private SumMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup(SumArguments arguments)
            {
                foreach (var invocationImposterGroup in _invocationImposters)
                {
                    if (invocationImposterGroup.ArgumentsCriteria.Matches(arguments))
                        return invocationImposterGroup;
                }

                return null;
            }

            public int Invoke(int[] values)
            {
                var arguments = new SumArguments(values);
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup(arguments);
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("int IArgumentMatchingService.Sum(params int[] values)");
                    }

                    matchingInvocationImposterGroup = SumMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "int IArgumentMatchingService.Sum(params int[] values)", values);
                    _sumMethodInvocationHistoryCollection.Add(new SumMethodInvocationHistory(arguments, result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _sumMethodInvocationHistoryCollection.Add(new SumMethodInvocationHistory(arguments, default !, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : ISumMethodImposterBuilder, ISumMethodInvocationImposterGroupContinuation
            {
                private readonly SumMethodImposter _imposter;
                private readonly SumMethodInvocationHistoryCollection _sumMethodInvocationHistoryCollection;
                private readonly SumArgumentsCriteria _argumentsCriteria;
                private readonly SumMethodInvocationImposterGroup _invocationImposterGroup;
                private SumMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(SumMethodImposter _imposter, SumMethodInvocationHistoryCollection _sumMethodInvocationHistoryCollection, SumArgumentsCriteria _argumentsCriteria)
                {
                    this._imposter = _imposter;
                    this._sumMethodInvocationHistoryCollection = _sumMethodInvocationHistoryCollection;
                    this._argumentsCriteria = _argumentsCriteria;
                    this._invocationImposterGroup = new SumMethodInvocationImposterGroup(_argumentsCriteria);
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                ISumMethodInvocationImposterGroupContinuation ISumMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws((int[] values) =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                ISumMethodInvocationImposterGroupContinuation ISumMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws((int[] values) =>
                    {
                        throw exception;
                    });
                    return this;
                }

                ISumMethodInvocationImposterGroupContinuation ISumMethodInvocationImposterGroup.Throws(SumExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws((int[] values) =>
                    {
                        throw exceptionGenerator.Invoke(values);
                    });
                    return this;
                }

                ISumMethodInvocationImposterGroupContinuation ISumMethodInvocationImposterGroupCallback.Callback(SumCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                ISumMethodInvocationImposterGroupContinuation ISumMethodInvocationImposterGroup.Returns(SumDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                ISumMethodInvocationImposterGroupContinuation ISumMethodInvocationImposterGroup.Returns(int value)
                {
                    _currentInvocationImposter.Returns(value);
                    return this;
                }

                ISumMethodInvocationImposterGroup ISumMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void SumInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _sumMethodInvocationHistoryCollection.Count(_argumentsCriteria);
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount, _sumMethodInvocationHistoryCollection.ToString());
                    }
                }
            }
        }

        public IArgumentMatchingServiceImposter(global::Imposter.Abstractions.ImposterMode invocationBehavior = global::Imposter.Abstractions.ImposterMode.Implicit)
        {
            this._addMethodImposter = new AddMethodImposter(_addMethodInvocationHistoryCollection, invocationBehavior);
            this._incrementMethodImposter = new IncrementMethodImposter(_incrementMethodInvocationHistoryCollection, invocationBehavior);
            this._sumMethodImposter = new SumMethodImposter(_sumMethodInvocationHistoryCollection, invocationBehavior);
            this._formatMethodImposter = new FormatMethodImposter(_formatMethodInvocationHistoryCollection, invocationBehavior);
            this._inOnlyMethodImposter = new InOnlyMethodImposter(_inOnlyMethodInvocationHistoryCollection, invocationBehavior);
            this._refOnlyMethodImposter = new RefOnlyMethodImposter(_refOnlyMethodInvocationHistoryCollection, invocationBehavior);
            this._outOnlyMethodImposter = new OutOnlyMethodImposter(_outOnlyMethodInvocationHistoryCollection, invocationBehavior);
            this._imposterInstance = new ImposterTargetInstance(this);
            this._invocationBehavior = invocationBehavior;
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class ImposterTargetInstance : global::Imposter.Tests.Features.Docs.ArgumentsMatching.IArgumentMatchingService
        {
            private readonly IArgumentMatchingServiceImposter _imposter;
            public ImposterTargetInstance(IArgumentMatchingServiceImposter _imposter)
            {
                this._imposter = _imposter;
            }

            public int Add(int a, int b)
            {
                return _imposter._addMethodImposter.Invoke(a, b);
            }

            public int Increment(int value)
            {
                return _imposter._incrementMethodImposter.Invoke(value);
            }

            public int Sum(int[] values)
            {
                return _imposter._sumMethodImposter.Invoke(values);
            }

            public string Format(string template, string value)
            {
                return _imposter._formatMethodImposter.Invoke(template, value);
            }

            public int InOnly(in int input)
            {
                return _imposter._inOnlyMethodImposter.Invoke(in input);
            }

            public int RefOnly(ref int state)
            {
                return _imposter._refOnlyMethodImposter.Invoke(ref state);
            }

            public int OutOnly(out int result)
            {
                return _imposter._outOnlyMethodImposter.Invoke(out result);
            }
        }
    }

    [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
    public static class IArgumentMatchingServiceImposterExtensions
    {
        extension(global::Imposter.Tests.Features.Docs.ArgumentsMatching.IArgumentMatchingService imposter)
        {
            public static global::Imposter.Tests.Features.Docs.ArgumentsMatching.IArgumentMatchingServiceImposter Imposter() => new global::Imposter.Tests.Features.Docs.ArgumentsMatching.IArgumentMatchingServiceImposter();
        }
    }
}
#nullable restore
