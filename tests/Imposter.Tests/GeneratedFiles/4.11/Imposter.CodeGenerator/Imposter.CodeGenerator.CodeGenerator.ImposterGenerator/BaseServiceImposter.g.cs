// <auto-generated />
#nullable enable
#pragma warning disable CS8608
using global::System;
using global::System.Linq;
using global::System.Collections.Generic;
using global::System.Threading.Tasks;
using global::System.Diagnostics;
using global::System.Runtime.CompilerServices;
using global::Imposter.Abstractions;
using global::System.Collections.Concurrent;
using global::Imposter.Tests.Features.Docs.GettingStarted;

namespace Imposter.Tests.Features.Docs.GettingStarted
{
    [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
    public sealed class BaseServiceImposter : global::Imposter.Abstractions.IHaveImposterInstance<global::Imposter.Tests.Features.Docs.GettingStarted.BaseService>
    {
        private readonly GetNumberMethodImposter _getNumberMethodImposter;
        private readonly GetNumberMethodInvocationHistoryCollection _getNumberMethodInvocationHistoryCollection = new GetNumberMethodInvocationHistoryCollection();
        public IGetNumberMethodImposterBuilder GetNumber()
        {
            return new GetNumberMethodImposter.Builder(_getNumberMethodImposter, _getNumberMethodInvocationHistoryCollection);
        }

        private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
        private ImposterTargetInstance _imposterInstance;
        global::Imposter.Tests.Features.Docs.GettingStarted.BaseService global::Imposter.Abstractions.IHaveImposterInstance<global::Imposter.Tests.Features.Docs.GettingStarted.BaseService>.Instance()
        {
            return _imposterInstance;
        }

        // virtual int BaseService.GetNumber()
        public delegate int GetNumberDelegate();
        // virtual int BaseService.GetNumber()
        public delegate void GetNumberCallbackDelegate();
        // virtual int BaseService.GetNumber()
        public delegate global::System.Exception GetNumberExceptionGeneratorDelegate();
        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IGetNumberMethodInvocationHistory
        {
            bool Matches();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class GetNumberMethodInvocationHistory : IGetNumberMethodInvocationHistory
        {
            internal int? Result;
            internal global::System.Exception? Exception;
            public GetNumberMethodInvocationHistory(int? Result, global::System.Exception? Exception)
            {
                this.Result = Result;
                this.Exception = Exception;
            }

            public bool Matches()
            {
                return true;
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class GetNumberMethodInvocationHistoryCollection
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<IGetNumberMethodInvocationHistory> _invocationHistory = new global::System.Collections.Concurrent.ConcurrentStack<IGetNumberMethodInvocationHistory>();
            internal void Add(IGetNumberMethodInvocationHistory invocationHistory)
            {
                _invocationHistory.Push(invocationHistory);
            }

            internal int Count()
            {
                return _invocationHistory.Count(it => it.Matches());
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class GetNumberMethodInvocationImposterGroup
        {
            internal static GetNumberMethodInvocationImposterGroup Default = new GetNumberMethodInvocationImposterGroup();
            private readonly global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentQueue<MethodInvocationImposter>();
            private MethodInvocationImposter? _lastestInvocationImposter;
            public GetNumberMethodInvocationImposterGroup()
            {
            }

            internal MethodInvocationImposter AddInvocationImposter()
            {
                MethodInvocationImposter invocationImposter = new MethodInvocationImposter();
                _invocationImposters.Enqueue(invocationImposter);
                return invocationImposter;
            }

            private MethodInvocationImposter? GetInvocationImposter()
            {
                if (_invocationImposters.TryDequeue(out var invocationImposter))
                {
                    if (!invocationImposter.IsEmpty)
                    {
                        _lastestInvocationImposter = invocationImposter;
                    }

                    return invocationImposter;
                }

                return _lastestInvocationImposter;
            }

            public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, GetNumberDelegate? baseImplementation = null)
            {
                var invocationImposter = GetInvocationImposter();
                if (invocationImposter == null)
                {
                    if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    invocationImposter = MethodInvocationImposter.Default;
                }

                return invocationImposter.Invoke(invocationBehavior, methodDisplayName, baseImplementation);
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class MethodInvocationImposter
            {
                internal static MethodInvocationImposter Default;
                static MethodInvocationImposter()
                {
                    Default = new MethodInvocationImposter();
                    Default.Returns(DefaultResultGenerator);
                }

                private GetNumberDelegate? _resultGenerator;
                private readonly global::System.Collections.Concurrent.ConcurrentQueue<GetNumberCallbackDelegate> _callbacks = new global::System.Collections.Concurrent.ConcurrentQueue<GetNumberCallbackDelegate>();
                private bool _useBaseImplementation;
                internal bool IsEmpty => !_useBaseImplementation && ((_resultGenerator == null) && (_callbacks.Count == 0));

                public int Invoke(global::Imposter.Abstractions.ImposterMode invocationBehavior, string methodDisplayName, GetNumberDelegate? baseImplementation = null)
                {
                    if (_useBaseImplementation)
                    {
                        _resultGenerator = baseImplementation ?? throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                    }

                    if (_resultGenerator == null)
                    {
                        if (invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                        {
                            throw new global::Imposter.Abstractions.MissingImposterException(methodDisplayName);
                        }

                        _resultGenerator = DefaultResultGenerator;
                    }

                    int result = _resultGenerator.Invoke();
                    foreach (var callback in _callbacks)
                    {
                        callback();
                    }

                    return result;
                }

                internal void Callback(GetNumberCallbackDelegate callback)
                {
                    _callbacks.Enqueue(callback);
                }

                internal void Returns(GetNumberDelegate resultGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = resultGenerator;
                }

                internal void Returns(int value)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = () =>
                    {
                        return value;
                    };
                }

                internal void Throws(GetNumberExceptionGeneratorDelegate exceptionGenerator)
                {
                    _useBaseImplementation = false;
                    _resultGenerator = () =>
                    {
                        throw exceptionGenerator();
                    };
                }

                internal void UseBaseImplementation()
                {
                    _useBaseImplementation = true;
                    _resultGenerator = null;
                }

                internal static int DefaultResultGenerator()
                {
                    return default !;
                }
            }
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IGetNumberMethodInvocationImposterGroupCallback
        {
            IGetNumberMethodInvocationImposterGroupContinuation Callback(GetNumberCallbackDelegate callback);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IGetNumberMethodInvocationImposterGroupContinuation : IGetNumberMethodInvocationImposterGroupCallback
        {
            IGetNumberMethodInvocationImposterGroup Then();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IGetNumberMethodInvocationImposterGroup : IGetNumberMethodInvocationImposterGroupCallback
        {
            IGetNumberMethodInvocationImposterGroupContinuation Throws<TException>()
                where TException : global::System.Exception, new();
            IGetNumberMethodInvocationImposterGroupContinuation Throws(global::System.Exception exception);
            IGetNumberMethodInvocationImposterGroupContinuation Throws(GetNumberExceptionGeneratorDelegate exceptionGenerator);
            IGetNumberMethodInvocationImposterGroupContinuation Returns(GetNumberDelegate resultGenerator);
            IGetNumberMethodInvocationImposterGroupContinuation Returns(int value);
            IGetNumberMethodInvocationImposterGroupContinuation UseBaseImplementation();
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface GetNumberInvocationVerifier
        {
            void Called(Count count);
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        public interface IGetNumberMethodImposterBuilder : IGetNumberMethodInvocationImposterGroup, IGetNumberMethodInvocationImposterGroupCallback, GetNumberInvocationVerifier
        {
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        internal class GetNumberMethodImposter
        {
            private readonly global::System.Collections.Concurrent.ConcurrentStack<GetNumberMethodInvocationImposterGroup> _invocationImposters = new global::System.Collections.Concurrent.ConcurrentStack<GetNumberMethodInvocationImposterGroup>();
            private readonly GetNumberMethodInvocationHistoryCollection _getNumberMethodInvocationHistoryCollection;
            private readonly global::Imposter.Abstractions.ImposterMode _invocationBehavior;
            public GetNumberMethodImposter(GetNumberMethodInvocationHistoryCollection _getNumberMethodInvocationHistoryCollection, global::Imposter.Abstractions.ImposterMode _invocationBehavior)
            {
                this._getNumberMethodInvocationHistoryCollection = _getNumberMethodInvocationHistoryCollection;
                this._invocationBehavior = _invocationBehavior;
            }

            public bool HasMatchingInvocationImposterGroup()
            {
                return FindMatchingInvocationImposterGroup() != null;
            }

            private GetNumberMethodInvocationImposterGroup? FindMatchingInvocationImposterGroup()
            {
                if (_invocationImposters.TryPeek(out var invocationImposterGroup))
                    return invocationImposterGroup;
                else
                    return null;
            }

            public int Invoke(GetNumberDelegate? baseImplementation = null)
            {
                var matchingInvocationImposterGroup = FindMatchingInvocationImposterGroup();
                if (matchingInvocationImposterGroup == default)
                {
                    if (_invocationBehavior == global::Imposter.Abstractions.ImposterMode.Explicit)
                    {
                        throw new global::Imposter.Abstractions.MissingImposterException("virtual int BaseService.GetNumber()");
                    }

                    matchingInvocationImposterGroup = GetNumberMethodInvocationImposterGroup.Default;
                }

                try
                {
                    var result = matchingInvocationImposterGroup.Invoke(_invocationBehavior, "virtual int BaseService.GetNumber()", baseImplementation);
                    _getNumberMethodInvocationHistoryCollection.Add(new GetNumberMethodInvocationHistory(result, default));
                    return result;
                }
                catch (global::System.Exception ex)
                {
                    _getNumberMethodInvocationHistoryCollection.Add(new GetNumberMethodInvocationHistory(default, ex));
                    throw;
                }
            }

            [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
            internal class Builder : IGetNumberMethodImposterBuilder, IGetNumberMethodInvocationImposterGroupContinuation
            {
                private readonly GetNumberMethodImposter _imposter;
                private readonly GetNumberMethodInvocationHistoryCollection _getNumberMethodInvocationHistoryCollection;
                private readonly GetNumberMethodInvocationImposterGroup _invocationImposterGroup;
                private GetNumberMethodInvocationImposterGroup.MethodInvocationImposter _currentInvocationImposter;
                public Builder(GetNumberMethodImposter _imposter, GetNumberMethodInvocationHistoryCollection _getNumberMethodInvocationHistoryCollection)
                {
                    this._imposter = _imposter;
                    this._getNumberMethodInvocationHistoryCollection = _getNumberMethodInvocationHistoryCollection;
                    this._invocationImposterGroup = new GetNumberMethodInvocationImposterGroup();
                    _imposter._invocationImposters.Push(_invocationImposterGroup);
                    this._currentInvocationImposter = this._invocationImposterGroup.AddInvocationImposter();
                }

                IGetNumberMethodInvocationImposterGroupContinuation IGetNumberMethodInvocationImposterGroup.Throws<TException>()
                {
                    _currentInvocationImposter.Throws(() =>
                    {
                        throw new TException();
                    });
                    return this;
                }

                IGetNumberMethodInvocationImposterGroupContinuation IGetNumberMethodInvocationImposterGroup.Throws(global::System.Exception exception)
                {
                    _currentInvocationImposter.Throws(() =>
                    {
                        throw exception;
                    });
                    return this;
                }

                IGetNumberMethodInvocationImposterGroupContinuation IGetNumberMethodInvocationImposterGroup.Throws(GetNumberExceptionGeneratorDelegate exceptionGenerator)
                {
                    _currentInvocationImposter.Throws(() =>
                    {
                        throw exceptionGenerator.Invoke();
                    });
                    return this;
                }

                IGetNumberMethodInvocationImposterGroupContinuation IGetNumberMethodInvocationImposterGroupCallback.Callback(GetNumberCallbackDelegate callback)
                {
                    _currentInvocationImposter.Callback(callback);
                    return this;
                }

                IGetNumberMethodInvocationImposterGroupContinuation IGetNumberMethodInvocationImposterGroup.Returns(GetNumberDelegate resultGenerator)
                {
                    _currentInvocationImposter.Returns(resultGenerator);
                    return this;
                }

                IGetNumberMethodInvocationImposterGroupContinuation IGetNumberMethodInvocationImposterGroup.Returns(int value)
                {
                    _currentInvocationImposter.Returns(value);
                    return this;
                }

                IGetNumberMethodInvocationImposterGroupContinuation IGetNumberMethodInvocationImposterGroup.UseBaseImplementation()
                {
                    _currentInvocationImposter.UseBaseImplementation();
                    return this;
                }

                IGetNumberMethodInvocationImposterGroup IGetNumberMethodInvocationImposterGroupContinuation.Then()
                {
                    this._currentInvocationImposter = _invocationImposterGroup.AddInvocationImposter();
                    return this;
                }

                void GetNumberInvocationVerifier.Called(global::Imposter.Abstractions.Count count)
                {
                    var invocationCount = _getNumberMethodInvocationHistoryCollection.Count();
                    if (!count.Matches(invocationCount))
                    {
                        throw new global::Imposter.Abstractions.VerificationFailedException(count, invocationCount);
                    }
                }
            }
        }

        public BaseServiceImposter(global::Imposter.Abstractions.ImposterMode invocationBehavior = global::Imposter.Abstractions.ImposterMode.Implicit)
        {
            this._getNumberMethodImposter = new GetNumberMethodImposter(_getNumberMethodInvocationHistoryCollection, invocationBehavior);
            this._imposterInstance = new ImposterTargetInstance(this);
            this._invocationBehavior = invocationBehavior;
        }

        [global::System.CodeDom.Compiler.GeneratedCode("Imposter.CodeGenerator", "0.1.0.0")]
        class ImposterTargetInstance : global::Imposter.Tests.Features.Docs.GettingStarted.BaseService
        {
            private readonly BaseServiceImposter _imposter;
            internal ImposterTargetInstance(BaseServiceImposter _imposter) : base()
            {
                this._imposter = _imposter;
            }

            public override int GetNumber()
            {
                return _imposter._getNumberMethodImposter.Invoke(base.GetNumber);
            }
        }
    }
}
#nullable restore
#pragma warning restore CS8608
